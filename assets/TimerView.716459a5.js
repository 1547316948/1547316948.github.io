import{_ as _r,A as ie,B as ae,G as L,H as Ct,x as Dn,I as An,J as ke,F as br,K as wr,E as xr,L as Er,M as Tr}from"./index.06fd301e.js";/*! *****************************************************************************
Copyright (c) Microsoft Corporation.
Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.
THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var R=function(){return R=Object.assign||function(t){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},R.apply(this,arguments)};function Ft(e,t,n){if(n||arguments.length===2)for(var r=0,i=t.length,a;r<i;r++)(a||!(r in t))&&(a||(a=Array.prototype.slice.call(t,0,r)),a[r]=t[r]);return e.concat(a||Array.prototype.slice.call(t))}var O=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,N=Object.keys,H=Array.isArray;typeof Promise<"u"&&!O.Promise&&(O.Promise=Promise);function W(e,t){return typeof t!="object"||N(t).forEach(function(n){e[n]=t[n]}),e}var Ue=Object.getPrototypeOf,Sr={}.hasOwnProperty;function Q(e,t){return Sr.call(e,t)}function Pe(e,t){typeof t=="function"&&(t=t(Ue(e))),(typeof Reflect>"u"?N:Reflect.ownKeys)(t).forEach(function(n){fe(e,n,t[n])})}var Ln=Object.defineProperty;function fe(e,t,n,r){Ln(e,t,W(n&&Q(n,"get")&&typeof n.get=="function"?{get:n.get,set:n.set,configurable:!0}:{value:n,configurable:!0,writable:!0},r))}function Me(e){return{from:function(t){return e.prototype=Object.create(t.prototype),fe(e.prototype,"constructor",e),{extend:Pe.bind(null,e.prototype)}}}}var Dr=Object.getOwnPropertyDescriptor;function sn(e,t){var n=Dr(e,t),r;return n||(r=Ue(e))&&sn(r,t)}var Ar=[].slice;function St(e,t,n){return Ar.call(e,t,n)}function Vn(e,t){return t(e)}function Ye(e){if(!e)throw new Error("Assertion Failed")}function Hn(e){O.setImmediate?setImmediate(e):setTimeout(e,0)}function Un(e,t){return e.reduce(function(n,r,i){var a=t(r,i);return a&&(n[a[0]]=a[1]),n},{})}function kr(e,t,n){try{e.apply(null,n)}catch(r){t&&t(r)}}function le(e,t){if(typeof t=="string"&&Q(e,t))return e[t];if(!t)return e;if(typeof t!="string"){for(var n=[],r=0,i=t.length;r<i;++r){var a=le(e,t[r]);n.push(a)}return n}var o=t.indexOf(".");if(o!==-1){var u=e[t.substr(0,o)];return u==null?void 0:le(u,t.substr(o+1))}}function $(e,t,n){if(!(!e||t===void 0)&&!("isFrozen"in Object&&Object.isFrozen(e)))if(typeof t!="string"&&"length"in t){Ye(typeof n!="string"&&"length"in n);for(var r=0,i=t.length;r<i;++r)$(e,t[r],n[r])}else{var a=t.indexOf(".");if(a!==-1){var o=t.substr(0,a),u=t.substr(a+1);if(u==="")n===void 0?H(e)&&!isNaN(parseInt(o))?e.splice(o,1):delete e[o]:e[o]=n;else{var s=e[o];(!s||!Q(e,o))&&(s=e[o]={}),$(s,u,n)}}else n===void 0?H(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=n}}function Cr(e,t){typeof t=="string"?$(e,t,void 0):"length"in t&&[].map.call(t,function(n){$(e,n,void 0)})}function zn(e){var t={};for(var n in e)Q(e,n)&&(t[n]=e[n]);return t}var Kr=[].concat;function Wn(e){return Kr.apply([],e)}var Gn="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(Wn([8,16,32,64].map(function(e){return["Int","Uint","Float"].map(function(t){return t+e+"Array"})}))).filter(function(e){return O[e]}),Rr=Gn.map(function(e){return O[e]});Un(Gn,function(e){return[e,!0]});var ye=null;function qe(e){ye=typeof WeakMap<"u"&&new WeakMap;var t=Nt(e);return ye=null,t}function Nt(e){if(!e||typeof e!="object")return e;var t=ye&&ye.get(e);if(t)return t;if(H(e)){t=[],ye&&ye.set(e,t);for(var n=0,r=e.length;n<r;++n)t.push(Nt(e[n]))}else if(Rr.indexOf(e.constructor)>=0)t=e;else{var i=Ue(e);t=i===Object.prototype?{}:Object.create(i),ye&&ye.set(e,t);for(var a in e)Q(e,a)&&(t[a]=Nt(e[a]))}return t}var Ir={}.toString;function Yt(e){return Ir.call(e).slice(8,-1)}var jt=typeof Symbol<"u"?Symbol.iterator:"@@iterator",Pr=typeof jt=="symbol"?function(e){var t;return e!=null&&(t=e[jt])&&t.apply(e)}:function(){return null},Re={};function se(e){var t,n,r,i;if(arguments.length===1){if(H(e))return e.slice();if(this===Re&&typeof e=="string")return[e];if(i=Pr(e)){for(n=[];r=i.next(),!r.done;)n.push(r.value);return n}if(e==null)return[e];if(t=e.length,typeof t=="number"){for(n=new Array(t);t--;)n[t]=e[t];return n}return[e]}for(t=arguments.length,n=new Array(t);t--;)n[t]=arguments[t];return n}var cn=typeof Symbol<"u"?function(e){return e[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},re=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function Qn(e,t){re=e,Xn=t}var Xn=function(){return!0},Mr=!new Error("").stack;function Ae(){if(Mr)try{throw Ae.arguments,new Error}catch(e){return e}return new Error}function Lt(e,t){var n=e.stack;return n?(t=t||0,n.indexOf(e.name)===0&&(t+=(e.name+e.message).split(`
`).length),n.split(`
`).slice(t).filter(Xn).map(function(r){return`
`+r}).join("")):""}var Br=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"],Jn=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],ln=Br.concat(Jn),Or={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function Be(e,t){this._e=Ae(),this.name=e,this.message=t}Me(Be).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+Lt(this._e,2))}},toString:function(){return this.name+": "+this.message}});function qn(e,t){return e+". Errors: "+Object.keys(t).map(function(n){return t[n].toString()}).filter(function(n,r,i){return i.indexOf(n)===r}).join(`
`)}function yt(e,t,n,r){this._e=Ae(),this.failures=t,this.failedKeys=r,this.successCount=n,this.message=qn(e,t)}Me(yt).from(Be);function Le(e,t){this._e=Ae(),this.name="BulkError",this.failures=Object.keys(t).map(function(n){return t[n]}),this.failuresByPos=t,this.message=qn(e,t)}Me(Le).from(Be);var fn=ln.reduce(function(e,t){return e[t]=t+"Error",e},{}),Fr=Be,k=ln.reduce(function(e,t){var n=t+"Error";function r(i,a){this._e=Ae(),this.name=n,i?typeof i=="string"?(this.message=""+i+(a?`
 `+a:""),this.inner=a||null):typeof i=="object"&&(this.message=i.name+" "+i.message,this.inner=i):(this.message=Or[t]||n,this.inner=null)}return Me(r).from(Fr),e[t]=r,e},{});k.Syntax=SyntaxError;k.Type=TypeError;k.Range=RangeError;var kn=Jn.reduce(function(e,t){return e[t+"Error"]=k[t],e},{});function Nr(e,t){if(!e||e instanceof Be||e instanceof TypeError||e instanceof SyntaxError||!e.name||!kn[e.name])return e;var n=new kn[e.name](t||e.message,e);return"stack"in e&&fe(n,"stack",{get:function(){return this.inner.stack}}),n}var Dt=ln.reduce(function(e,t){return["Syntax","Type","Range"].indexOf(t)===-1&&(e[t+"Error"]=k[t]),e},{});Dt.ModifyError=yt;Dt.DexieError=Be;Dt.BulkError=Le;function B(){}function Ze(e){return e}function Yr(e,t){return e==null||e===Ze?t:function(n){return t(e(n))}}function Se(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function jr(e,t){return e===B?t:function(){var n=e.apply(this,arguments);n!==void 0&&(arguments[0]=n);var r=this.onsuccess,i=this.onerror;this.onsuccess=null,this.onerror=null;var a=t.apply(this,arguments);return r&&(this.onsuccess=this.onsuccess?Se(r,this.onsuccess):r),i&&(this.onerror=this.onerror?Se(i,this.onerror):i),a!==void 0?a:n}}function Lr(e,t){return e===B?t:function(){e.apply(this,arguments);var n=this.onsuccess,r=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),n&&(this.onsuccess=this.onsuccess?Se(n,this.onsuccess):n),r&&(this.onerror=this.onerror?Se(r,this.onerror):r)}}function Vr(e,t){return e===B?t:function(n){var r=e.apply(this,arguments);W(n,r);var i=this.onsuccess,a=this.onerror;this.onsuccess=null,this.onerror=null;var o=t.apply(this,arguments);return i&&(this.onsuccess=this.onsuccess?Se(i,this.onsuccess):i),a&&(this.onerror=this.onerror?Se(a,this.onerror):a),r===void 0?o===void 0?void 0:o:W(r,o)}}function Hr(e,t){return e===B?t:function(){return t.apply(this,arguments)===!1?!1:e.apply(this,arguments)}}function hn(e,t){return e===B?t:function(){var n=e.apply(this,arguments);if(n&&typeof n.then=="function"){for(var r=this,i=arguments.length,a=new Array(i);i--;)a[i]=arguments[i];return n.then(function(){return t.apply(r,a)})}return t.apply(this,arguments)}}var ze={},Ur=100,zr=20,Zn=100,dn=typeof Promise>"u"?[]:function(){var e=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[e,Ue(e),e];var t=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[t,Ue(t),e]}(),Vt=dn[0],mt=dn[1],Ht=dn[2],$n=mt&&mt.then,lt=Vt&&Vt.constructor,pn=!!Ht,Ut=!1,Wr=Ht?function(){Ht.then(it)}:O.setImmediate?setImmediate.bind(null,it):O.MutationObserver?function(){var e=document.createElement("div");new MutationObserver(function(){it(),e=null}).observe(e,{attributes:!0}),e.setAttribute("i","1")}:function(){setTimeout(it,0)},We=function(e,t){je.push([e,t]),gt&&(Wr(),gt=!1)},zt=!0,gt=!0,Ee=[],ft=[],Wt=null,Gt=Ze,Ie={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:Rn,pgp:!1,env:{},finalize:function(){this.unhandleds.forEach(function(e){try{Rn(e[0],e[1])}catch{}})}},S=Ie,je=[],Te=0,ht=[];function T(e){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=B,this._lib=!1;var t=this._PSD=S;if(re&&(this._stackHolder=Ae(),this._prev=null,this._numPrev=0),typeof e!="function"){if(e!==ze)throw new TypeError("Not a function");this._state=arguments[1],this._value=arguments[2],this._state===!1&&Xt(this,this._value);return}this._state=null,this._value=null,++t.ref,tr(this,e)}var Qt={get:function(){var e=S,t=_t;function n(r,i){var a=this,o=!e.global&&(e!==S||t!==_t),u=o&&!he(),s=new T(function(c,h){vn(a,new er(wt(r,e,o,u),wt(i,e,o,u),c,h,e))});return re&&ir(s,this),s}return n.prototype=ze,n},set:function(e){fe(this,"then",e&&e.prototype===ze?Qt:{get:function(){return e},set:Qt.set})}};Pe(T.prototype,{then:Qt,_then:function(e,t){vn(this,new er(null,null,e,t,S))},catch:function(e){if(arguments.length===1)return this.then(null,e);var t=arguments[0],n=arguments[1];return typeof t=="function"?this.then(null,function(r){return r instanceof t?n(r):dt(r)}):this.then(null,function(r){return r&&r.name===t?n(r):dt(r)})},finally:function(e){return this.then(function(t){return e(),t},function(t){return e(),dt(t)})},stack:{get:function(){if(this._stack)return this._stack;try{Ut=!0;var e=rr(this,[],zr),t=e.join(`
From previous: `);return this._state!==null&&(this._stack=t),t}finally{Ut=!1}}},timeout:function(e,t){var n=this;return e<1/0?new T(function(r,i){var a=setTimeout(function(){return i(new k.Timeout(t))},e);n.then(r,i).finally(clearTimeout.bind(null,a))}):this}});typeof Symbol<"u"&&Symbol.toStringTag&&fe(T.prototype,Symbol.toStringTag,"Dexie.Promise");Ie.env=ar();function er(e,t,n,r,i){this.onFulfilled=typeof e=="function"?e:null,this.onRejected=typeof t=="function"?t:null,this.resolve=n,this.reject=r,this.psd=i}Pe(T,{all:function(){var e=se.apply(null,arguments).map(bt);return new T(function(t,n){e.length===0&&t([]);var r=e.length;e.forEach(function(i,a){return T.resolve(i).then(function(o){e[a]=o,--r||t(e)},n)})})},resolve:function(e){if(e instanceof T)return e;if(e&&typeof e.then=="function")return new T(function(n,r){e.then(n,r)});var t=new T(ze,!0,e);return ir(t,Wt),t},reject:dt,race:function(){var e=se.apply(null,arguments).map(bt);return new T(function(t,n){e.map(function(r){return T.resolve(r).then(t,n)})})},PSD:{get:function(){return S},set:function(e){return S=e}},totalEchoes:{get:function(){return _t}},newPSD:ge,usePSD:Fe,scheduler:{get:function(){return We},set:function(e){We=e}},rejectionMapper:{get:function(){return Gt},set:function(e){Gt=e}},follow:function(e,t){return new T(function(n,r){return ge(function(i,a){var o=S;o.unhandleds=[],o.onunhandled=a,o.finalize=Se(function(){var u=this;Qr(function(){u.unhandleds.length===0?i():a(u.unhandleds[0])})},o.finalize),e()},t,n,r)})}});lt&&(lt.allSettled&&fe(T,"allSettled",function(){var e=se.apply(null,arguments).map(bt);return new T(function(t){e.length===0&&t([]);var n=e.length,r=new Array(n);e.forEach(function(i,a){return T.resolve(i).then(function(o){return r[a]={status:"fulfilled",value:o}},function(o){return r[a]={status:"rejected",reason:o}}).then(function(){return--n||t(r)})})})}),lt.any&&typeof AggregateError<"u"&&fe(T,"any",function(){var e=se.apply(null,arguments).map(bt);return new T(function(t,n){e.length===0&&n(new AggregateError([]));var r=e.length,i=new Array(r);e.forEach(function(a,o){return T.resolve(a).then(function(u){return t(u)},function(u){i[o]=u,--r||n(new AggregateError(i))})})})}));function tr(e,t){try{t(function(n){if(e._state===null){if(n===e)throw new TypeError("A promise cannot be resolved with itself.");var r=e._lib&&$e();n&&typeof n.then=="function"?tr(e,function(i,a){n instanceof T?n._then(i,a):n.then(i,a)}):(e._state=!0,e._value=n,nr(e)),r&&et()}},Xt.bind(null,e))}catch(n){Xt(e,n)}}function Xt(e,t){if(ft.push(t),e._state===null){var n=e._lib&&$e();t=Gt(t),e._state=!1,e._value=t,re&&t!==null&&typeof t=="object"&&!t._promise&&kr(function(){var r=sn(t,"stack");t._promise=e,fe(t,"stack",{get:function(){return Ut?r&&(r.get?r.get.apply(t):r.value):e.stack}})}),Xr(e),nr(e),n&&et()}}function nr(e){var t=e._listeners;e._listeners=[];for(var n=0,r=t.length;n<r;++n)vn(e,t[n]);var i=e._PSD;--i.ref||i.finalize(),Te===0&&(++Te,We(function(){--Te===0&&yn()},[]))}function vn(e,t){if(e._state===null){e._listeners.push(t);return}var n=e._state?t.onFulfilled:t.onRejected;if(n===null)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++Te,We(Gr,[n,e,t])}function Gr(e,t,n){try{Wt=t;var r,i=t._value;t._state?r=e(i):(ft.length&&(ft=[]),r=e(i),ft.indexOf(i)===-1&&Jr(t)),n.resolve(r)}catch(a){n.reject(a)}finally{Wt=null,--Te===0&&yn(),--n.psd.ref||n.psd.finalize()}}function rr(e,t,n){if(t.length===n)return t;var r="";if(e._state===!1){var i=e._value,a,o;i!=null?(a=i.name||"Error",o=i.message||i,r=Lt(i,0)):(a=i,o=""),t.push(a+(o?": "+o:"")+r)}return re&&(r=Lt(e._stackHolder,2),r&&t.indexOf(r)===-1&&t.push(r),e._prev&&rr(e._prev,t,n)),t}function ir(e,t){var n=t?t._numPrev+1:0;n<Ur&&(e._prev=t,e._numPrev=n)}function it(){$e()&&et()}function $e(){var e=zt;return zt=!1,gt=!1,e}function et(){var e,t,n;do for(;je.length>0;)for(e=je,je=[],n=e.length,t=0;t<n;++t){var r=e[t];r[0].apply(null,r[1])}while(je.length>0);zt=!0,gt=!0}function yn(){var e=Ee;Ee=[],e.forEach(function(r){r._PSD.onunhandled.call(null,r._value,r)});for(var t=ht.slice(0),n=t.length;n;)t[--n]()}function Qr(e){function t(){e(),ht.splice(ht.indexOf(t),1)}ht.push(t),++Te,We(function(){--Te===0&&yn()},[])}function Xr(e){Ee.some(function(t){return t._value===e._value})||Ee.push(e)}function Jr(e){for(var t=Ee.length;t;)if(Ee[--t]._value===e._value){Ee.splice(t,1);return}}function dt(e){return new T(ze,!1,e)}function F(e,t){var n=S;return function(){var r=$e(),i=S;try{return _e(n,!0),e.apply(this,arguments)}catch(a){t&&t(a)}finally{_e(i,!1),r&&et()}}}var V={awaits:0,echoes:0,id:0},qr=0,pt=[],Kt=0,_t=0,Zr=0;function ge(e,t,n,r){var i=S,a=Object.create(i);a.parent=i,a.ref=0,a.global=!1,a.id=++Zr;var o=Ie.env;a.env=pn?{Promise:T,PromiseProp:{value:T,configurable:!0,writable:!0},all:T.all,race:T.race,allSettled:T.allSettled,any:T.any,resolve:T.resolve,reject:T.reject,nthen:Cn(o.nthen,a),gthen:Cn(o.gthen,a)}:{},t&&W(a,t),++i.ref,a.finalize=function(){--this.parent.ref||this.parent.finalize()};var u=Fe(a,e,n,r);return a.ref===0&&a.finalize(),u}function Oe(){return V.id||(V.id=++qr),++V.awaits,V.echoes+=Zn,V.id}function he(){return V.awaits?(--V.awaits===0&&(V.id=0),V.echoes=V.awaits*Zn,!0):!1}(""+$n).indexOf("[native code]")===-1&&(Oe=he=B);function bt(e){return V.echoes&&e&&e.constructor===lt?(Oe(),e.then(function(t){return he(),t},function(t){return he(),Y(t)})):e}function $r(e){++_t,(!V.echoes||--V.echoes===0)&&(V.echoes=V.id=0),pt.push(S),_e(e,!0)}function ei(){var e=pt[pt.length-1];pt.pop(),_e(e,!1)}function _e(e,t){var n=S;if((t?V.echoes&&(!Kt++||e!==S):Kt&&(!--Kt||e!==S))&&or(t?$r.bind(null,e):ei),e!==S&&(S=e,n===Ie&&(Ie.env=ar()),pn)){var r=Ie.env.Promise,i=e.env;mt.then=i.nthen,r.prototype.then=i.gthen,(n.global||e.global)&&(Object.defineProperty(O,"Promise",i.PromiseProp),r.all=i.all,r.race=i.race,r.resolve=i.resolve,r.reject=i.reject,i.allSettled&&(r.allSettled=i.allSettled),i.any&&(r.any=i.any))}}function ar(){var e=O.Promise;return pn?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(O,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject,nthen:mt.then,gthen:e.prototype.then}:{}}function Fe(e,t,n,r,i){var a=S;try{return _e(e,!0),t(n,r,i)}finally{_e(a,!1)}}function or(e){$n.call(Vt,e)}function wt(e,t,n,r){return typeof e!="function"?e:function(){var i=S;n&&Oe(),_e(t,!0);try{return e.apply(this,arguments)}finally{_e(i,!1),r&&or(he)}}}function Cn(e,t){return function(n,r){return e.call(this,wt(n,t),wt(r,t))}}var Kn="unhandledrejection";function Rn(e,t){var n;try{n=t.onuncatched(e)}catch{}if(n!==!1)try{var r,i={promise:t,reason:e};if(O.document&&document.createEvent?(r=document.createEvent("Event"),r.initEvent(Kn,!0,!0),W(r,i)):O.CustomEvent&&(r=new CustomEvent(Kn,{detail:i}),W(r,i)),r&&O.dispatchEvent&&(dispatchEvent(r),!O.PromiseRejectionEvent&&O.onunhandledrejection))try{O.onunhandledrejection(r)}catch{}re&&r&&!r.defaultPrevented&&console.warn("Unhandled rejection: "+(e.stack||e))}catch{}}var Y=T.reject;function Jt(e,t,n,r){if(!e.idbdb||!e._state.openComplete&&!S.letThrough&&!e._vip){if(e._state.openComplete)return Y(new k.DatabaseClosed(e._state.dbOpenError));if(!e._state.isBeingOpened){if(!e._options.autoOpen)return Y(new k.DatabaseClosed);e.open().catch(B)}return e._state.dbReadyPromise.then(function(){return Jt(e,t,n,r)})}else{var i=e._createTransaction(t,n,e._dbSchema);try{i.create(),e._state.PR1398_maxLoop=3}catch(a){return a.name===fn.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e._close(),e.open().then(function(){return Jt(e,t,n,r)})):Y(a)}return i._promise(t,function(a,o){return ge(function(){return S.trans=i,r(a,o,i)})}).then(function(a){return i._completion.then(function(){return a})})}}var In="3.2.6",xe=String.fromCharCode(65535),qt=-1/0,oe="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",ur="String expected.",Ve=[],At=typeof navigator<"u"&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),ti=At,ni=At,sr=function(e){return!/(dexie\.js|dexie\.min\.js)/.test(e)},kt="__dbnames",Rt="readonly",It="readwrite";function De(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}var cr={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function at(e){return typeof e=="string"&&!/\./.test(e)?function(t){return t[e]===void 0&&e in t&&(t=qe(t),delete t[e]),t}:function(t){return t}}var ri=function(){function e(){}return e.prototype._trans=function(t,n,r){var i=this._tx||S.trans,a=this.name;function o(s,c,h){if(!h.schema[a])throw new k.NotFound("Table "+a+" not part of transaction");return n(h.idbtrans,h)}var u=$e();try{return i&&i.db===this.db?i===S.trans?i._promise(t,o,r):ge(function(){return i._promise(t,o,r)},{trans:i,transless:S.transless||S}):Jt(this.db,t,[this.name],o)}finally{u&&et()}},e.prototype.get=function(t,n){var r=this;return t&&t.constructor===Object?this.where(t).first(n):this._trans("readonly",function(i){return r.core.get({trans:i,key:t}).then(function(a){return r.hook.reading.fire(a)})}).then(n)},e.prototype.where=function(t){if(typeof t=="string")return new this.db.WhereClause(this,t);if(H(t))return new this.db.WhereClause(this,"["+t.join("+")+"]");var n=N(t);if(n.length===1)return this.where(n[0]).equals(t[n[0]]);var r=this.schema.indexes.concat(this.schema.primKey).filter(function(l){if(l.compound&&n.every(function(w){return l.keyPath.indexOf(w)>=0})){for(var f=0;f<n.length;++f)if(n.indexOf(l.keyPath[f])===-1)return!1;return!0}return!1}).sort(function(l,f){return l.keyPath.length-f.keyPath.length})[0];if(r&&this.db._maxKey!==xe){var i=r.keyPath.slice(0,n.length);return this.where(i).equals(i.map(function(l){return t[l]}))}!r&&re&&console.warn("The query "+JSON.stringify(t)+" on "+this.name+" would benefit of a "+("compound index ["+n.join("+")+"]"));var a=this.schema.idxByName,o=this.db._deps.indexedDB;function u(l,f){try{return o.cmp(l,f)===0}catch{return!1}}var s=n.reduce(function(l,f){var w=l[0],y=l[1],d=a[f],p=t[f];return[w||d,w||!d?De(y,d&&d.multi?function(_){var g=le(_,f);return H(g)&&g.some(function(m){return u(p,m)})}:function(_){return u(p,le(_,f))}):y]},[null,null]),c=s[0],h=s[1];return c?this.where(c.name).equals(t[c.keyPath]).filter(h):r?this.filter(h):this.where(n).equals("")},e.prototype.filter=function(t){return this.toCollection().and(t)},e.prototype.count=function(t){return this.toCollection().count(t)},e.prototype.offset=function(t){return this.toCollection().offset(t)},e.prototype.limit=function(t){return this.toCollection().limit(t)},e.prototype.each=function(t){return this.toCollection().each(t)},e.prototype.toArray=function(t){return this.toCollection().toArray(t)},e.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},e.prototype.orderBy=function(t){return new this.db.Collection(new this.db.WhereClause(this,H(t)?"["+t.join("+")+"]":t))},e.prototype.reverse=function(){return this.toCollection().reverse()},e.prototype.mapToClass=function(t){this.schema.mappedClass=t;var n=function(r){if(!r)return r;var i=Object.create(t.prototype);for(var a in r)if(Q(r,a))try{i[a]=r[a]}catch{}return i};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=n,this.hook("reading",n),t},e.prototype.defineClass=function(){function t(n){W(this,n)}return this.mapToClass(t)},e.prototype.add=function(t,n){var r=this,i=this.schema.primKey,a=i.auto,o=i.keyPath,u=t;return o&&a&&(u=at(o)(t)),this._trans("readwrite",function(s){return r.core.mutate({trans:s,type:"add",keys:n!=null?[n]:null,values:[u]})}).then(function(s){return s.numFailures?T.reject(s.failures[0]):s.lastResult}).then(function(s){if(o)try{$(t,o,s)}catch{}return s})},e.prototype.update=function(t,n){if(typeof t=="object"&&!H(t)){var r=le(t,this.schema.primKey.keyPath);if(r===void 0)return Y(new k.InvalidArgument("Given object does not contain its primary key"));try{typeof n!="function"?N(n).forEach(function(i){$(t,i,n[i])}):n(t,{value:t,primKey:r})}catch{}return this.where(":id").equals(r).modify(n)}else return this.where(":id").equals(t).modify(n)},e.prototype.put=function(t,n){var r=this,i=this.schema.primKey,a=i.auto,o=i.keyPath,u=t;return o&&a&&(u=at(o)(t)),this._trans("readwrite",function(s){return r.core.mutate({trans:s,type:"put",values:[u],keys:n!=null?[n]:null})}).then(function(s){return s.numFailures?T.reject(s.failures[0]):s.lastResult}).then(function(s){if(o)try{$(t,o,s)}catch{}return s})},e.prototype.delete=function(t){var n=this;return this._trans("readwrite",function(r){return n.core.mutate({trans:r,type:"delete",keys:[t]})}).then(function(r){return r.numFailures?T.reject(r.failures[0]):void 0})},e.prototype.clear=function(){var t=this;return this._trans("readwrite",function(n){return t.core.mutate({trans:n,type:"deleteRange",range:cr})}).then(function(n){return n.numFailures?T.reject(n.failures[0]):void 0})},e.prototype.bulkGet=function(t){var n=this;return this._trans("readonly",function(r){return n.core.getMany({keys:t,trans:r}).then(function(i){return i.map(function(a){return n.hook.reading.fire(a)})})})},e.prototype.bulkAdd=function(t,n,r){var i=this,a=Array.isArray(n)?n:void 0;r=r||(a?void 0:n);var o=r?r.allKeys:void 0;return this._trans("readwrite",function(u){var s=i.schema.primKey,c=s.auto,h=s.keyPath;if(h&&a)throw new k.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(a&&a.length!==t.length)throw new k.InvalidArgument("Arguments objects and keys must have the same length");var l=t.length,f=h&&c?t.map(at(h)):t;return i.core.mutate({trans:u,type:"add",keys:a,values:f,wantResults:o}).then(function(w){var y=w.numFailures,d=w.results,p=w.lastResult,_=w.failures,g=o?d:p;if(y===0)return g;throw new Le(i.name+".bulkAdd(): "+y+" of "+l+" operations failed",_)})})},e.prototype.bulkPut=function(t,n,r){var i=this,a=Array.isArray(n)?n:void 0;r=r||(a?void 0:n);var o=r?r.allKeys:void 0;return this._trans("readwrite",function(u){var s=i.schema.primKey,c=s.auto,h=s.keyPath;if(h&&a)throw new k.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(a&&a.length!==t.length)throw new k.InvalidArgument("Arguments objects and keys must have the same length");var l=t.length,f=h&&c?t.map(at(h)):t;return i.core.mutate({trans:u,type:"put",keys:a,values:f,wantResults:o}).then(function(w){var y=w.numFailures,d=w.results,p=w.lastResult,_=w.failures,g=o?d:p;if(y===0)return g;throw new Le(i.name+".bulkPut(): "+y+" of "+l+" operations failed",_)})})},e.prototype.bulkDelete=function(t){var n=this,r=t.length;return this._trans("readwrite",function(i){return n.core.mutate({trans:i,type:"delete",keys:t})}).then(function(i){var a=i.numFailures,o=i.lastResult,u=i.failures;if(a===0)return o;throw new Le(n.name+".bulkDelete(): "+a+" of "+r+" operations failed",u)})},e}();function tt(e){var t={},n=function(u,s){if(s){for(var c=arguments.length,h=new Array(c-1);--c;)h[c-1]=arguments[c];return t[u].subscribe.apply(null,h),e}else if(typeof u=="string")return t[u]};n.addEventType=a;for(var r=1,i=arguments.length;r<i;++r)a(arguments[r]);return n;function a(u,s,c){if(typeof u=="object")return o(u);s||(s=Hr),c||(c=B);var h={subscribers:[],fire:c,subscribe:function(l){h.subscribers.indexOf(l)===-1&&(h.subscribers.push(l),h.fire=s(h.fire,l))},unsubscribe:function(l){h.subscribers=h.subscribers.filter(function(f){return f!==l}),h.fire=h.subscribers.reduce(s,c)}};return t[u]=n[u]=h,h}function o(u){N(u).forEach(function(s){var c=u[s];if(H(c))a(s,u[s][0],u[s][1]);else if(c==="asap")var h=a(s,Ze,function(){for(var f=arguments.length,w=new Array(f);f--;)w[f]=arguments[f];h.subscribers.forEach(function(y){Hn(function(){y.apply(null,w)})})});else throw new k.InvalidArgument("Invalid event config")})}}function nt(e,t){return Me(t).from({prototype:e}),t}function ii(e){return nt(ri.prototype,function(n,r,i){this.db=e,this._tx=i,this.name=n,this.schema=r,this.hook=e._allTables[n]?e._allTables[n].hook:tt(null,{creating:[jr,B],reading:[Yr,Ze],updating:[Vr,B],deleting:[Lr,B]})})}function Ce(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function Pt(e,t){e.filter=De(e.filter,t)}function Mt(e,t,n){var r=e.replayFilter;e.replayFilter=r?function(){return De(r(),t())}:t,e.justLimit=n&&!r}function ai(e,t){e.isMatch=De(e.isMatch,t)}function vt(e,t){if(e.isPrimKey)return t.primaryKey;var n=t.getIndexByKeyPath(e.index);if(!n)throw new k.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return n}function Pn(e,t,n){var r=vt(e,t.schema);return t.openCursor({trans:n,values:!e.keysOnly,reverse:e.dir==="prev",unique:!!e.unique,query:{index:r,range:e.range}})}function ot(e,t,n,r){var i=e.replayFilter?De(e.filter,e.replayFilter()):e.filter;if(e.or){var a={},o=function(u,s,c){if(!i||i(s,c,function(f){return s.stop(f)},function(f){return s.fail(f)})){var h=s.primaryKey,l=""+h;l==="[object ArrayBuffer]"&&(l=""+new Uint8Array(h)),Q(a,l)||(a[l]=!0,t(u,s,c))}};return Promise.all([e.or._iterate(o,n),Mn(Pn(e,r,n),e.algorithm,o,!e.keysOnly&&e.valueMapper)])}else return Mn(Pn(e,r,n),De(e.algorithm,i),t,!e.keysOnly&&e.valueMapper)}function Mn(e,t,n,r){var i=r?function(o,u,s){return n(r(o),u,s)}:n,a=F(i);return e.then(function(o){if(o)return o.start(function(){var u=function(){return o.continue()};(!t||t(o,function(s){return u=s},function(s){o.stop(s),u=B},function(s){o.fail(s),u=B}))&&a(o.value,o,function(s){return u=s}),u()})})}function z(e,t){try{var n=Bn(e),r=Bn(t);if(n!==r)return n==="Array"?1:r==="Array"?-1:n==="binary"?1:r==="binary"?-1:n==="string"?1:r==="string"?-1:n==="Date"?1:r!=="Date"?NaN:-1;switch(n){case"number":case"Date":case"string":return e>t?1:e<t?-1:0;case"binary":return ui(On(e),On(t));case"Array":return oi(e,t)}}catch{}return NaN}function oi(e,t){for(var n=e.length,r=t.length,i=n<r?n:r,a=0;a<i;++a){var o=z(e[a],t[a]);if(o!==0)return o}return n===r?0:n<r?-1:1}function ui(e,t){for(var n=e.length,r=t.length,i=n<r?n:r,a=0;a<i;++a)if(e[a]!==t[a])return e[a]<t[a]?-1:1;return n===r?0:n<r?-1:1}function Bn(e){var t=typeof e;if(t!=="object")return t;if(ArrayBuffer.isView(e))return"binary";var n=Yt(e);return n==="ArrayBuffer"?"binary":n}function On(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}var si=function(){function e(){}return e.prototype._read=function(t,n){var r=this._ctx;return r.error?r.table._trans(null,Y.bind(null,r.error)):r.table._trans("readonly",t).then(n)},e.prototype._write=function(t){var n=this._ctx;return n.error?n.table._trans(null,Y.bind(null,n.error)):n.table._trans("readwrite",t,"locked")},e.prototype._addAlgorithm=function(t){var n=this._ctx;n.algorithm=De(n.algorithm,t)},e.prototype._iterate=function(t,n){return ot(this._ctx,t,n,this._ctx.table.core)},e.prototype.clone=function(t){var n=Object.create(this.constructor.prototype),r=Object.create(this._ctx);return t&&W(r,t),n._ctx=r,n},e.prototype.raw=function(){return this._ctx.valueMapper=null,this},e.prototype.each=function(t){var n=this._ctx;return this._read(function(r){return ot(n,t,r,n.table.core)})},e.prototype.count=function(t){var n=this;return this._read(function(r){var i=n._ctx,a=i.table.core;if(Ce(i,!0))return a.count({trans:r,query:{index:vt(i,a.schema),range:i.range}}).then(function(u){return Math.min(u,i.limit)});var o=0;return ot(i,function(){return++o,!1},r,a).then(function(){return o})}).then(t)},e.prototype.sortBy=function(t,n){var r=t.split(".").reverse(),i=r[0],a=r.length-1;function o(c,h){return h?o(c[r[h]],h-1):c[i]}var u=this._ctx.dir==="next"?1:-1;function s(c,h){var l=o(c,a),f=o(h,a);return l<f?-u:l>f?u:0}return this.toArray(function(c){return c.sort(s)}).then(n)},e.prototype.toArray=function(t){var n=this;return this._read(function(r){var i=n._ctx;if(i.dir==="next"&&Ce(i,!0)&&i.limit>0){var a=i.valueMapper,o=vt(i,i.table.core.schema);return i.table.core.query({trans:r,limit:i.limit,values:!0,query:{index:o,range:i.range}}).then(function(s){var c=s.result;return a?c.map(a):c})}else{var u=[];return ot(i,function(s){return u.push(s)},r,i.table.core).then(function(){return u})}},t)},e.prototype.offset=function(t){var n=this._ctx;return t<=0?this:(n.offset+=t,Ce(n)?Mt(n,function(){var r=t;return function(i,a){return r===0?!0:r===1?(--r,!1):(a(function(){i.advance(r),r=0}),!1)}}):Mt(n,function(){var r=t;return function(){return--r<0}}),this)},e.prototype.limit=function(t){return this._ctx.limit=Math.min(this._ctx.limit,t),Mt(this._ctx,function(){var n=t;return function(r,i,a){return--n<=0&&i(a),n>=0}},!0),this},e.prototype.until=function(t,n){return Pt(this._ctx,function(r,i,a){return t(r.value)?(i(a),n):!0}),this},e.prototype.first=function(t){return this.limit(1).toArray(function(n){return n[0]}).then(t)},e.prototype.last=function(t){return this.reverse().first(t)},e.prototype.filter=function(t){return Pt(this._ctx,function(n){return t(n.value)}),ai(this._ctx,t),this},e.prototype.and=function(t){return this.filter(t)},e.prototype.or=function(t){return new this.db.WhereClause(this._ctx.table,t,this)},e.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},e.prototype.desc=function(){return this.reverse()},e.prototype.eachKey=function(t){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each(function(r,i){t(i.key,i)})},e.prototype.eachUniqueKey=function(t){return this._ctx.unique="unique",this.eachKey(t)},e.prototype.eachPrimaryKey=function(t){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each(function(r,i){t(i.primaryKey,i)})},e.prototype.keys=function(t){var n=this._ctx;n.keysOnly=!n.isMatch;var r=[];return this.each(function(i,a){r.push(a.key)}).then(function(){return r}).then(t)},e.prototype.primaryKeys=function(t){var n=this._ctx;if(n.dir==="next"&&Ce(n,!0)&&n.limit>0)return this._read(function(i){var a=vt(n,n.table.core.schema);return n.table.core.query({trans:i,values:!1,limit:n.limit,query:{index:a,range:n.range}})}).then(function(i){var a=i.result;return a}).then(t);n.keysOnly=!n.isMatch;var r=[];return this.each(function(i,a){r.push(a.primaryKey)}).then(function(){return r}).then(t)},e.prototype.uniqueKeys=function(t){return this._ctx.unique="unique",this.keys(t)},e.prototype.firstKey=function(t){return this.limit(1).keys(function(n){return n[0]}).then(t)},e.prototype.lastKey=function(t){return this.reverse().firstKey(t)},e.prototype.distinct=function(){var t=this._ctx,n=t.index&&t.table.schema.idxByName[t.index];if(!n||!n.multi)return this;var r={};return Pt(this._ctx,function(i){var a=i.primaryKey.toString(),o=Q(r,a);return r[a]=!0,!o}),this},e.prototype.modify=function(t){var n=this,r=this._ctx;return this._write(function(i){var a;if(typeof t=="function")a=t;else{var o=N(t),u=o.length;a=function(_){for(var g=!1,m=0;m<u;++m){var b=o[m],v=t[b];le(_,b)!==v&&($(_,b,v),g=!0)}return g}}var s=r.table.core,c=s.schema.primaryKey,h=c.outbound,l=c.extractKey,f=n.db._options.modifyChunkSize||200,w=[],y=0,d=[],p=function(_,g){var m=g.failures,b=g.numFailures;y+=_-b;for(var v=0,x=N(m);v<x.length;v++){var D=x[v];w.push(m[D])}};return n.clone().primaryKeys().then(function(_){var g=function(m){var b=Math.min(f,_.length-m);return s.getMany({trans:i,keys:_.slice(m,m+b),cache:"immutable"}).then(function(v){for(var x=[],D=[],E=h?[]:null,A=[],C=0;C<b;++C){var P=v[C],M={value:qe(P),primKey:_[m+C]};a.call(M,M.value,M)!==!1&&(M.value==null?A.push(_[m+C]):!h&&z(l(P),l(M.value))!==0?(A.push(_[m+C]),x.push(M.value)):(D.push(M.value),h&&E.push(_[m+C])))}var I=Ce(r)&&r.limit===1/0&&(typeof t!="function"||t===Bt)&&{index:r.index,range:r.range};return Promise.resolve(x.length>0&&s.mutate({trans:i,type:"add",values:x}).then(function(j){for(var K in j.failures)A.splice(parseInt(K),1);p(x.length,j)})).then(function(){return(D.length>0||I&&typeof t=="object")&&s.mutate({trans:i,type:"put",keys:E,values:D,criteria:I,changeSpec:typeof t!="function"&&t}).then(function(j){return p(D.length,j)})}).then(function(){return(A.length>0||I&&t===Bt)&&s.mutate({trans:i,type:"delete",keys:A,criteria:I}).then(function(j){return p(A.length,j)})}).then(function(){return _.length>m+b&&g(m+f)})})};return g(0).then(function(){if(w.length>0)throw new yt("Error modifying one or more objects",w,y,d);return _.length})})})},e.prototype.delete=function(){var t=this._ctx,n=t.range;return Ce(t)&&(t.isPrimKey&&!ni||n.type===3)?this._write(function(r){var i=t.table.core.schema.primaryKey,a=n;return t.table.core.count({trans:r,query:{index:i,range:a}}).then(function(o){return t.table.core.mutate({trans:r,type:"deleteRange",range:a}).then(function(u){var s=u.failures;u.lastResult,u.results;var c=u.numFailures;if(c)throw new yt("Could not delete some values",Object.keys(s).map(function(h){return s[h]}),o-c);return o-c})})}):this.modify(Bt)},e}(),Bt=function(e,t){return t.value=null};function ci(e){return nt(si.prototype,function(n,r){this.db=e;var i=cr,a=null;if(r)try{i=r()}catch(c){a=c}var o=n._ctx,u=o.table,s=u.hook.reading.fire;this._ctx={table:u,index:o.index,isPrimKey:!o.index||u.schema.primKey.keyPath&&o.index===u.schema.primKey.name,range:i,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:a,or:o.or,valueMapper:s!==Ze?s:null}})}function li(e,t){return e<t?-1:e===t?0:1}function fi(e,t){return e>t?-1:e===t?0:1}function G(e,t,n){var r=e instanceof fr?new e.Collection(e):e;return r._ctx.error=n?new n(t):new TypeError(t),r}function Ke(e){return new e.Collection(e,function(){return lr("")}).limit(0)}function hi(e){return e==="next"?function(t){return t.toUpperCase()}:function(t){return t.toLowerCase()}}function di(e){return e==="next"?function(t){return t.toLowerCase()}:function(t){return t.toUpperCase()}}function pi(e,t,n,r,i,a){for(var o=Math.min(e.length,r.length),u=-1,s=0;s<o;++s){var c=t[s];if(c!==r[s])return i(e[s],n[s])<0?e.substr(0,s)+n[s]+n.substr(s+1):i(e[s],r[s])<0?e.substr(0,s)+r[s]+n.substr(s+1):u>=0?e.substr(0,u)+t[u]+n.substr(u+1):null;i(e[s],c)<0&&(u=s)}return o<r.length&&a==="next"?e+n.substr(e.length):o<e.length&&a==="prev"?e.substr(0,n.length):u<0?null:e.substr(0,u)+r[u]+n.substr(u+1)}function ut(e,t,n,r){var i,a,o,u,s,c,h,l=n.length;if(!n.every(function(d){return typeof d=="string"}))return G(e,ur);function f(d){i=hi(d),a=di(d),o=d==="next"?li:fi;var p=n.map(function(_){return{lower:a(_),upper:i(_)}}).sort(function(_,g){return o(_.lower,g.lower)});u=p.map(function(_){return _.upper}),s=p.map(function(_){return _.lower}),c=d,h=d==="next"?"":r}f("next");var w=new e.Collection(e,function(){return ve(u[0],s[l-1]+r)});w._ondirectionchange=function(d){f(d)};var y=0;return w._addAlgorithm(function(d,p,_){var g=d.key;if(typeof g!="string")return!1;var m=a(g);if(t(m,s,y))return!0;for(var b=null,v=y;v<l;++v){var x=pi(g,m,u[v],s[v],o,c);x===null&&b===null?y=v+1:(b===null||o(b,x)>0)&&(b=x)}return p(b!==null?function(){d.continue(b+h)}:_),!1}),w}function ve(e,t,n,r){return{type:2,lower:e,upper:t,lowerOpen:n,upperOpen:r}}function lr(e){return{type:1,lower:e,upper:e}}var fr=function(){function e(){}return Object.defineProperty(e.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),e.prototype.between=function(t,n,r,i){r=r!==!1,i=i===!0;try{return this._cmp(t,n)>0||this._cmp(t,n)===0&&(r||i)&&!(r&&i)?Ke(this):new this.Collection(this,function(){return ve(t,n,!r,!i)})}catch{return G(this,oe)}},e.prototype.equals=function(t){return t==null?G(this,oe):new this.Collection(this,function(){return lr(t)})},e.prototype.above=function(t){return t==null?G(this,oe):new this.Collection(this,function(){return ve(t,void 0,!0)})},e.prototype.aboveOrEqual=function(t){return t==null?G(this,oe):new this.Collection(this,function(){return ve(t,void 0,!1)})},e.prototype.below=function(t){return t==null?G(this,oe):new this.Collection(this,function(){return ve(void 0,t,!1,!0)})},e.prototype.belowOrEqual=function(t){return t==null?G(this,oe):new this.Collection(this,function(){return ve(void 0,t)})},e.prototype.startsWith=function(t){return typeof t!="string"?G(this,ur):this.between(t,t+xe,!0,!0)},e.prototype.startsWithIgnoreCase=function(t){return t===""?this.startsWith(t):ut(this,function(n,r){return n.indexOf(r[0])===0},[t],xe)},e.prototype.equalsIgnoreCase=function(t){return ut(this,function(n,r){return n===r[0]},[t],"")},e.prototype.anyOfIgnoreCase=function(){var t=se.apply(Re,arguments);return t.length===0?Ke(this):ut(this,function(n,r){return r.indexOf(n)!==-1},t,"")},e.prototype.startsWithAnyOfIgnoreCase=function(){var t=se.apply(Re,arguments);return t.length===0?Ke(this):ut(this,function(n,r){return r.some(function(i){return n.indexOf(i)===0})},t,xe)},e.prototype.anyOf=function(){var t=this,n=se.apply(Re,arguments),r=this._cmp;try{n.sort(r)}catch{return G(this,oe)}if(n.length===0)return Ke(this);var i=new this.Collection(this,function(){return ve(n[0],n[n.length-1])});i._ondirectionchange=function(o){r=o==="next"?t._ascending:t._descending,n.sort(r)};var a=0;return i._addAlgorithm(function(o,u,s){for(var c=o.key;r(c,n[a])>0;)if(++a,a===n.length)return u(s),!1;return r(c,n[a])===0?!0:(u(function(){o.continue(n[a])}),!1)}),i},e.prototype.notEqual=function(t){return this.inAnyRange([[qt,t],[t,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},e.prototype.noneOf=function(){var t=se.apply(Re,arguments);if(t.length===0)return new this.Collection(this);try{t.sort(this._ascending)}catch{return G(this,oe)}var n=t.reduce(function(r,i){return r?r.concat([[r[r.length-1][1],i]]):[[qt,i]]},null);return n.push([t[t.length-1],this.db._maxKey]),this.inAnyRange(n,{includeLowers:!1,includeUppers:!1})},e.prototype.inAnyRange=function(t,n){var r=this,i=this._cmp,a=this._ascending,o=this._descending,u=this._min,s=this._max;if(t.length===0)return Ke(this);if(!t.every(function(v){return v[0]!==void 0&&v[1]!==void 0&&a(v[0],v[1])<=0}))return G(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",k.InvalidArgument);var c=!n||n.includeLowers!==!1,h=n&&n.includeUppers===!0;function l(v,x){for(var D=0,E=v.length;D<E;++D){var A=v[D];if(i(x[0],A[1])<0&&i(x[1],A[0])>0){A[0]=u(A[0],x[0]),A[1]=s(A[1],x[1]);break}}return D===E&&v.push(x),v}var f=a;function w(v,x){return f(v[0],x[0])}var y;try{y=t.reduce(l,[]),y.sort(w)}catch{return G(this,oe)}var d=0,p=h?function(v){return a(v,y[d][1])>0}:function(v){return a(v,y[d][1])>=0},_=c?function(v){return o(v,y[d][0])>0}:function(v){return o(v,y[d][0])>=0};function g(v){return!p(v)&&!_(v)}var m=p,b=new this.Collection(this,function(){return ve(y[0][0],y[y.length-1][1],!c,!h)});return b._ondirectionchange=function(v){v==="next"?(m=p,f=a):(m=_,f=o),y.sort(w)},b._addAlgorithm(function(v,x,D){for(var E=v.key;m(E);)if(++d,d===y.length)return x(D),!1;return g(E)?!0:(r._cmp(E,y[d][1])===0||r._cmp(E,y[d][0])===0||x(function(){f===a?v.continue(y[d][0]):v.continue(y[d][1])}),!1)}),b},e.prototype.startsWithAnyOf=function(){var t=se.apply(Re,arguments);return t.every(function(n){return typeof n=="string"})?t.length===0?Ke(this):this.inAnyRange(t.map(function(n){return[n,n+xe]})):G(this,"startsWithAnyOf() only works with strings")},e}();function vi(e){return nt(fr.prototype,function(n,r,i){this.db=e,this._ctx={table:n,index:r===":id"?null:r,or:i};var a=e._deps.indexedDB;if(!a)throw new k.MissingAPI;this._cmp=this._ascending=a.cmp.bind(a),this._descending=function(o,u){return a.cmp(u,o)},this._max=function(o,u){return a.cmp(o,u)>0?o:u},this._min=function(o,u){return a.cmp(o,u)<0?o:u},this._IDBKeyRange=e._deps.IDBKeyRange})}function ne(e){return F(function(t){return Ge(t),e(t.target.error),!1})}function Ge(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}var Qe="storagemutated",me="x-storagemutated-1",be=tt(null,Qe),yi=function(){function e(){}return e.prototype._lock=function(){return Ye(!S.global),++this._reculock,this._reculock===1&&!S.global&&(S.lockOwnerFor=this),this},e.prototype._unlock=function(){if(Ye(!S.global),--this._reculock===0)for(S.global||(S.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var t=this._blockedFuncs.shift();try{Fe(t[1],t[0])}catch{}}return this},e.prototype._locked=function(){return this._reculock&&S.lockOwnerFor!==this},e.prototype.create=function(t){var n=this;if(!this.mode)return this;var r=this.db.idbdb,i=this.db._state.dbOpenError;if(Ye(!this.idbtrans),!t&&!r)switch(i&&i.name){case"DatabaseClosedError":throw new k.DatabaseClosed(i);case"MissingAPIError":throw new k.MissingAPI(i.message,i);default:throw new k.OpenFailed(i)}if(!this.active)throw new k.TransactionInactive;return Ye(this._completion._state===null),t=this.idbtrans=t||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):r.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})),t.onerror=F(function(a){Ge(a),n._reject(t.error)}),t.onabort=F(function(a){Ge(a),n.active&&n._reject(new k.Abort(t.error)),n.active=!1,n.on("abort").fire(a)}),t.oncomplete=F(function(){n.active=!1,n._resolve(),"mutatedParts"in t&&be.storagemutated.fire(t.mutatedParts)}),this},e.prototype._promise=function(t,n,r){var i=this;if(t==="readwrite"&&this.mode!=="readwrite")return Y(new k.ReadOnly("Transaction is readonly"));if(!this.active)return Y(new k.TransactionInactive);if(this._locked())return new T(function(o,u){i._blockedFuncs.push([function(){i._promise(t,n,r).then(o,u)},S])});if(r)return ge(function(){var o=new T(function(u,s){i._lock();var c=n(u,s,i);c&&c.then&&c.then(u,s)});return o.finally(function(){return i._unlock()}),o._lib=!0,o});var a=new T(function(o,u){var s=n(o,u,i);s&&s.then&&s.then(o,u)});return a._lib=!0,a},e.prototype._root=function(){return this.parent?this.parent._root():this},e.prototype.waitFor=function(t){var n=this._root(),r=T.resolve(t);if(n._waitingFor)n._waitingFor=n._waitingFor.then(function(){return r});else{n._waitingFor=r,n._waitingQueue=[];var i=n.idbtrans.objectStore(n.storeNames[0]);(function o(){for(++n._spinCount;n._waitingQueue.length;)n._waitingQueue.shift()();n._waitingFor&&(i.get(-1/0).onsuccess=o)})()}var a=n._waitingFor;return new T(function(o,u){r.then(function(s){return n._waitingQueue.push(F(o.bind(null,s)))},function(s){return n._waitingQueue.push(F(u.bind(null,s)))}).finally(function(){n._waitingFor===a&&(n._waitingFor=null)})})},e.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new k.Abort))},e.prototype.table=function(t){var n=this._memoizedTables||(this._memoizedTables={});if(Q(n,t))return n[t];var r=this.schema[t];if(!r)throw new k.NotFound("Table "+t+" not part of transaction");var i=new this.db.Table(t,r,this);return i.core=this.db.core.table(t),n[t]=i,i},e}();function mi(e){return nt(yi.prototype,function(n,r,i,a,o){var u=this;this.db=e,this.mode=n,this.storeNames=r,this.schema=i,this.chromeTransactionDurability=a,this.idbtrans=null,this.on=tt(this,"complete","error","abort"),this.parent=o||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new T(function(s,c){u._resolve=s,u._reject=c}),this._completion.then(function(){u.active=!1,u.on.complete.fire()},function(s){var c=u.active;return u.active=!1,u.on.error.fire(s),u.parent?u.parent._reject(s):c&&u.idbtrans&&u.idbtrans.abort(),Y(s)})})}function Zt(e,t,n,r,i,a,o){return{name:e,keyPath:t,unique:n,multi:r,auto:i,compound:a,src:(n&&!o?"&":"")+(r?"*":"")+(i?"++":"")+hr(t)}}function hr(e){return typeof e=="string"?e:e?"["+[].join.call(e,"+")+"]":""}function dr(e,t,n){return{name:e,primKey:t,indexes:n,mappedClass:null,idxByName:Un(n,function(r){return[r.name,r]})}}function gi(e){return e.length===1?e[0]:e}var Xe=function(e){try{return e.only([[]]),Xe=function(){return[[]]},[[]]}catch{return Xe=function(){return xe},xe}};function $t(e){return e==null?function(){}:typeof e=="string"?_i(e):function(t){return le(t,e)}}function _i(e){var t=e.split(".");return t.length===1?function(n){return n[e]}:function(n){return le(n,e)}}function Fn(e){return[].slice.call(e)}var bi=0;function He(e){return e==null?":id":typeof e=="string"?e:"["+e.join("+")+"]"}function wi(e,t,n){function r(l,f){var w=Fn(l.objectStoreNames);return{schema:{name:l.name,tables:w.map(function(y){return f.objectStore(y)}).map(function(y){var d=y.keyPath,p=y.autoIncrement,_=H(d),g=d==null,m={},b={name:y.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:g,compound:_,keyPath:d,autoIncrement:p,unique:!0,extractKey:$t(d)},indexes:Fn(y.indexNames).map(function(v){return y.index(v)}).map(function(v){var x=v.name,D=v.unique,E=v.multiEntry,A=v.keyPath,C=H(A),P={name:x,compound:C,keyPath:A,unique:D,multiEntry:E,extractKey:$t(A)};return m[He(A)]=P,P}),getIndexByKeyPath:function(v){return m[He(v)]}};return m[":id"]=b.primaryKey,d!=null&&(m[He(d)]=b.primaryKey),b})},hasGetAll:w.length>0&&"getAll"in f.objectStore(w[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}function i(l){if(l.type===3)return null;if(l.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var f=l.lower,w=l.upper,y=l.lowerOpen,d=l.upperOpen,p=f===void 0?w===void 0?null:t.upperBound(w,!!d):w===void 0?t.lowerBound(f,!!y):t.bound(f,w,!!y,!!d);return p}function a(l){var f=l.name;function w(p){var _=p.trans,g=p.type,m=p.keys,b=p.values,v=p.range;return new Promise(function(x,D){x=F(x);var E=_.objectStore(f),A=E.keyPath==null,C=g==="put"||g==="add";if(!C&&g!=="delete"&&g!=="deleteRange")throw new Error("Invalid operation type: "+g);var P=(m||b||{length:1}).length;if(m&&b&&m.length!==b.length)throw new Error("Given keys array must have same length as given values array.");if(P===0)return x({numFailures:0,failures:{},results:[],lastResult:void 0});var M,I=[],j=[],K=0,X=function(te){++K,Ge(te)};if(g==="deleteRange"){if(v.type===4)return x({numFailures:K,failures:j,results:[],lastResult:void 0});v.type===3?I.push(M=E.clear()):I.push(M=E.delete(i(v)))}else{var q=C?A?[b,m]:[b,null]:[m,null],de=q[0],ee=q[1];if(C)for(var J=0;J<P;++J)I.push(M=ee&&ee[J]!==void 0?E[g](de[J],ee[J]):E[g](de[J])),M.onerror=X;else for(var J=0;J<P;++J)I.push(M=E[g](de[J])),M.onerror=X}var pe=function(te){var Ne=te.target.result;I.forEach(function(Z,rt){return Z.error!=null&&(j[rt]=Z.error)}),x({numFailures:K,failures:j,results:g==="delete"?m:I.map(function(Z){return Z.result}),lastResult:Ne})};M.onerror=function(te){X(te),pe(te)},M.onsuccess=pe})}function y(p){var _=p.trans,g=p.values,m=p.query,b=p.reverse,v=p.unique;return new Promise(function(x,D){x=F(x);var E=m.index,A=m.range,C=_.objectStore(f),P=E.isPrimaryKey?C:C.index(E.name),M=b?v?"prevunique":"prev":v?"nextunique":"next",I=g||!("openKeyCursor"in P)?P.openCursor(i(A),M):P.openKeyCursor(i(A),M);I.onerror=ne(D),I.onsuccess=F(function(j){var K=I.result;if(!K){x(null);return}K.___id=++bi,K.done=!1;var X=K.continue.bind(K),q=K.continuePrimaryKey;q&&(q=q.bind(K));var de=K.advance.bind(K),ee=function(){throw new Error("Cursor not started")},J=function(){throw new Error("Cursor not stopped")};K.trans=_,K.stop=K.continue=K.continuePrimaryKey=K.advance=ee,K.fail=F(D),K.next=function(){var pe=this,te=1;return this.start(function(){return te--?pe.continue():pe.stop()}).then(function(){return pe})},K.start=function(pe){var te=new Promise(function(Z,rt){Z=F(Z),I.onerror=ne(rt),K.fail=rt,K.stop=function(gr){K.stop=K.continue=K.continuePrimaryKey=K.advance=J,Z(gr)}}),Ne=function(){if(I.result)try{pe()}catch(Z){K.fail(Z)}else K.done=!0,K.start=function(){throw new Error("Cursor behind last entry")},K.stop()};return I.onsuccess=F(function(Z){I.onsuccess=Ne,Ne()}),K.continue=X,K.continuePrimaryKey=q,K.advance=de,Ne(),te},x(K)},D)})}function d(p){return function(_){return new Promise(function(g,m){g=F(g);var b=_.trans,v=_.values,x=_.limit,D=_.query,E=x===1/0?void 0:x,A=D.index,C=D.range,P=b.objectStore(f),M=A.isPrimaryKey?P:P.index(A.name),I=i(C);if(x===0)return g({result:[]});if(p){var j=v?M.getAll(I,E):M.getAllKeys(I,E);j.onsuccess=function(de){return g({result:de.target.result})},j.onerror=ne(m)}else{var K=0,X=v||!("openKeyCursor"in M)?M.openCursor(I):M.openKeyCursor(I),q=[];X.onsuccess=function(de){var ee=X.result;if(!ee)return g({result:q});if(q.push(v?ee.value:ee.primaryKey),++K===x)return g({result:q});ee.continue()},X.onerror=ne(m)}})}}return{name:f,schema:l,mutate:w,getMany:function(p){var _=p.trans,g=p.keys;return new Promise(function(m,b){m=F(m);for(var v=_.objectStore(f),x=g.length,D=new Array(x),E=0,A=0,C,P=function(K){var X=K.target;(D[X._pos]=X.result)!=null,++A===E&&m(D)},M=ne(b),I=0;I<x;++I){var j=g[I];j!=null&&(C=v.get(g[I]),C._pos=I,C.onsuccess=P,C.onerror=M,++E)}E===0&&m(D)})},get:function(p){var _=p.trans,g=p.key;return new Promise(function(m,b){m=F(m);var v=_.objectStore(f),x=v.get(g);x.onsuccess=function(D){return m(D.target.result)},x.onerror=ne(b)})},query:d(s),openCursor:y,count:function(p){var _=p.query,g=p.trans,m=_.index,b=_.range;return new Promise(function(v,x){var D=g.objectStore(f),E=m.isPrimaryKey?D:D.index(m.name),A=i(b),C=A?E.count(A):E.count();C.onsuccess=F(function(P){return v(P.target.result)}),C.onerror=ne(x)})}}}var o=r(e,n),u=o.schema,s=o.hasGetAll,c=u.tables.map(function(l){return a(l)}),h={};return c.forEach(function(l){return h[l.name]=l}),{stack:"dbcore",transaction:e.transaction.bind(e),table:function(l){var f=h[l];if(!f)throw new Error("Table '"+l+"' not found");return h[l]},MIN_KEY:-1/0,MAX_KEY:Xe(t),schema:u}}function xi(e,t){return t.reduce(function(n,r){var i=r.create;return R(R({},n),i(n))},e)}function Ei(e,t,n,r){var i=n.IDBKeyRange;n.indexedDB;var a=xi(wi(t,i,r),e.dbcore);return{dbcore:a}}function mn(e,t){var n=e._novip,r=t.db,i=Ei(n._middlewares,r,n._deps,t);n.core=i.dbcore,n.tables.forEach(function(a){var o=a.name;n.core.schema.tables.some(function(u){return u.name===o})&&(a.core=n.core.table(o),n[o]instanceof n.Table&&(n[o].core=a.core))})}function xt(e,t,n,r){var i=e._novip;n.forEach(function(a){var o=r[a];t.forEach(function(u){var s=sn(u,a);(!s||"value"in s&&s.value===void 0)&&(u===i.Transaction.prototype||u instanceof i.Transaction?fe(u,a,{get:function(){return this.table(a)},set:function(c){Ln(this,a,{value:c,writable:!0,configurable:!0,enumerable:!0})}}):u[a]=new i.Table(a,o))})})}function en(e,t){var n=e._novip;t.forEach(function(r){for(var i in r)r[i]instanceof n.Table&&delete r[i]})}function Ti(e,t){return e._cfg.version-t._cfg.version}function Si(e,t,n,r){var i=e._dbSchema,a=e._createTransaction("readwrite",e._storeNames,i);a.create(n),a._completion.catch(r);var o=a._reject.bind(a),u=S.transless||S;ge(function(){S.trans=a,S.transless=u,t===0?(N(i).forEach(function(s){gn(n,s,i[s].primKey,i[s].indexes)}),mn(e,n),T.follow(function(){return e.on.populate.fire(a)}).catch(o)):Di(e,t,a,n).catch(o)})}function Di(e,t,n,r){var i=e._novip,a=[],o=i._versions,u=i._dbSchema=_n(i,i.idbdb,r),s=!1,c=o.filter(function(l){return l._cfg.version>=t});c.forEach(function(l){a.push(function(){var f=u,w=l._cfg.dbschema;nn(i,f,r),nn(i,w,r),u=i._dbSchema=w;var y=pr(f,w);y.add.forEach(function(b){gn(r,b[0],b[1].primKey,b[1].indexes)}),y.change.forEach(function(b){if(b.recreate)throw new k.Upgrade("Not yet support for changing primary key");var v=r.objectStore(b.name);b.add.forEach(function(x){return tn(v,x)}),b.change.forEach(function(x){v.deleteIndex(x.name),tn(v,x)}),b.del.forEach(function(x){return v.deleteIndex(x)})});var d=l._cfg.contentUpgrade;if(d&&l._cfg.version>t){mn(i,r),n._memoizedTables={},s=!0;var p=zn(w);y.del.forEach(function(b){p[b]=f[b]}),en(i,[i.Transaction.prototype]),xt(i,[i.Transaction.prototype],N(p),p),n.schema=p;var _=cn(d);_&&Oe();var g,m=T.follow(function(){if(g=d(n),g&&_){var b=he.bind(null,null);g.then(b,b)}});return g&&typeof g.then=="function"?T.resolve(g):m.then(function(){return g})}}),a.push(function(f){if(!s||!ti){var w=l._cfg.dbschema;ki(w,f)}en(i,[i.Transaction.prototype]),xt(i,[i.Transaction.prototype],i._storeNames,i._dbSchema),n.schema=i._dbSchema})});function h(){return a.length?T.resolve(a.shift()(n.idbtrans)).then(h):T.resolve()}return h().then(function(){Ai(u,r)})}function pr(e,t){var n={del:[],add:[],change:[]},r;for(r in e)t[r]||n.del.push(r);for(r in t){var i=e[r],a=t[r];if(!i)n.add.push([r,a]);else{var o={name:r,def:a,recreate:!1,del:[],add:[],change:[]};if(""+(i.primKey.keyPath||"")!=""+(a.primKey.keyPath||"")||i.primKey.auto!==a.primKey.auto&&!At)o.recreate=!0,n.change.push(o);else{var u=i.idxByName,s=a.idxByName,c=void 0;for(c in u)s[c]||o.del.push(c);for(c in s){var h=u[c],l=s[c];h?h.src!==l.src&&o.change.push(l):o.add.push(l)}(o.del.length>0||o.add.length>0||o.change.length>0)&&n.change.push(o)}}}return n}function gn(e,t,n,r){var i=e.db.createObjectStore(t,n.keyPath?{keyPath:n.keyPath,autoIncrement:n.auto}:{autoIncrement:n.auto});return r.forEach(function(a){return tn(i,a)}),i}function Ai(e,t){N(e).forEach(function(n){t.db.objectStoreNames.contains(n)||gn(t,n,e[n].primKey,e[n].indexes)})}function ki(e,t){[].slice.call(t.db.objectStoreNames).forEach(function(n){return e[n]==null&&t.db.deleteObjectStore(n)})}function tn(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function _n(e,t,n){var r={},i=St(t.objectStoreNames,0);return i.forEach(function(a){for(var o=n.objectStore(a),u=o.keyPath,s=Zt(hr(u),u||"",!1,!1,!!o.autoIncrement,u&&typeof u!="string",!0),c=[],h=0;h<o.indexNames.length;++h){var l=o.index(o.indexNames[h]);u=l.keyPath;var f=Zt(l.name,u,!!l.unique,!!l.multiEntry,!1,u&&typeof u!="string",!1);c.push(f)}r[a]=dr(a,s,c)}),r}function Ci(e,t,n){var r=e._novip;r.verno=t.version/10;var i=r._dbSchema=_n(r,t,n);r._storeNames=St(t.objectStoreNames,0),xt(r,[r._allTables],N(i),i)}function Ki(e,t){var n=_n(e,e.idbdb,t),r=pr(n,e._dbSchema);return!(r.add.length||r.change.some(function(i){return i.add.length||i.change.length}))}function nn(e,t,n){for(var r=e._novip,i=n.db.objectStoreNames,a=0;a<i.length;++a){var o=i[a],u=n.objectStore(o);r._hasGetAll="getAll"in u;for(var s=0;s<u.indexNames.length;++s){var c=u.indexNames[s],h=u.index(c).keyPath,l=typeof h=="string"?h:"["+St(h).join("+")+"]";if(t[o]){var f=t[o].idxByName[l];f&&(f.name=c,delete t[o].idxByName[l],t[o].idxByName[c]=f)}}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&O.WorkerGlobalScope&&O instanceof O.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(r._hasGetAll=!1)}function Ri(e){return e.split(",").map(function(t,n){t=t.trim();var r=t.replace(/([&*]|\+\+)/g,""),i=/^\[/.test(r)?r.match(/^\[(.*)\]$/)[1].split("+"):r;return Zt(r,i||null,/\&/.test(t),/\*/.test(t),/\+\+/.test(t),H(i),n===0)})}var Ii=function(){function e(){}return e.prototype._parseStoresSpec=function(t,n){N(t).forEach(function(r){if(t[r]!==null){var i=Ri(t[r]),a=i.shift();if(a.multi)throw new k.Schema("Primary key cannot be multi-valued");i.forEach(function(o){if(o.auto)throw new k.Schema("Only primary key can be marked as autoIncrement (++)");if(!o.keyPath)throw new k.Schema("Index must have a name and cannot be an empty string")}),n[r]=dr(r,a,i)}})},e.prototype.stores=function(t){var n=this.db;this._cfg.storesSource=this._cfg.storesSource?W(this._cfg.storesSource,t):t;var r=n._versions,i={},a={};return r.forEach(function(o){W(i,o._cfg.storesSource),a=o._cfg.dbschema={},o._parseStoresSpec(i,a)}),n._dbSchema=a,en(n,[n._allTables,n,n.Transaction.prototype]),xt(n,[n._allTables,n,n.Transaction.prototype,this._cfg.tables],N(a),a),n._storeNames=N(a),this},e.prototype.upgrade=function(t){return this._cfg.contentUpgrade=hn(this._cfg.contentUpgrade||B,t),this},e}();function Pi(e){return nt(Ii.prototype,function(n){this.db=e,this._cfg={version:n,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})}function bn(e,t){var n=e._dbNamesDB;return n||(n=e._dbNamesDB=new Tn(kt,{addons:[],indexedDB:e,IDBKeyRange:t}),n.version(1).stores({dbnames:"name"})),n.table("dbnames")}function wn(e){return e&&typeof e.databases=="function"}function Mi(e){var t=e.indexedDB,n=e.IDBKeyRange;return wn(t)?Promise.resolve(t.databases()).then(function(r){return r.map(function(i){return i.name}).filter(function(i){return i!==kt})}):bn(t,n).toCollection().primaryKeys()}function Bi(e,t){var n=e.indexedDB,r=e.IDBKeyRange;!wn(n)&&t!==kt&&bn(n,r).put({name:t}).catch(B)}function Oi(e,t){var n=e.indexedDB,r=e.IDBKeyRange;!wn(n)&&t!==kt&&bn(n,r).delete(t).catch(B)}function rn(e){return ge(function(){return S.letThrough=!0,e()})}function Fi(){var e=!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent);if(!e||!indexedDB.databases)return Promise.resolve();var t;return new Promise(function(n){var r=function(){return indexedDB.databases().finally(n)};t=setInterval(r,100),r()}).finally(function(){return clearInterval(t)})}function Ni(e){var t=e._state,n=e._deps.indexedDB;if(t.isBeingOpened||e.idbdb)return t.dbReadyPromise.then(function(){return t.dbOpenError?Y(t.dbOpenError):e});re&&(t.openCanceller._stackHolder=Ae()),t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;var r=t.openCanceller;function i(){if(t.openCanceller!==r)throw new k.DatabaseClosed("db.open() was cancelled")}var a=t.dbReadyResolve,o=null,u=!1,s=function(){return new T(function(c,h){if(i(),!n)throw new k.MissingAPI;var l=e.name,f=t.autoSchema?n.open(l):n.open(l,Math.round(e.verno*10));if(!f)throw new k.MissingAPI;f.onerror=ne(h),f.onblocked=F(e._fireOnBlocked),f.onupgradeneeded=F(function(w){if(o=f.transaction,t.autoSchema&&!e._options.allowEmptyDB){f.onerror=Ge,o.abort(),f.result.close();var y=n.deleteDatabase(l);y.onsuccess=y.onerror=F(function(){h(new k.NoSuchDatabase("Database "+l+" doesnt exist"))})}else{o.onerror=ne(h);var d=w.oldVersion>Math.pow(2,62)?0:w.oldVersion;u=d<1,e._novip.idbdb=f.result,Si(e,d/10,o,h)}},h),f.onsuccess=F(function(){o=null;var w=e._novip.idbdb=f.result,y=St(w.objectStoreNames);if(y.length>0)try{var d=w.transaction(gi(y),"readonly");t.autoSchema?Ci(e,w,d):(nn(e,e._dbSchema,d),Ki(e,d)||console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Some queries may fail.")),mn(e,d)}catch{}Ve.push(e),w.onversionchange=F(function(p){t.vcFired=!0,e.on("versionchange").fire(p)}),w.onclose=F(function(p){e.on("close").fire(p)}),u&&Bi(e._deps,l),c()},h)}).catch(function(c){return c&&c.name==="UnknownError"&&t.PR1398_maxLoop>0?(t.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),s()):T.reject(c)})};return T.race([r,(typeof navigator>"u"?T.resolve():Fi()).then(s)]).then(function(){return i(),t.onReadyBeingFired=[],T.resolve(rn(function(){return e.on.ready.fire(e.vip)})).then(function c(){if(t.onReadyBeingFired.length>0){var h=t.onReadyBeingFired.reduce(hn,B);return t.onReadyBeingFired=[],T.resolve(rn(function(){return h(e.vip)})).then(c)}})}).finally(function(){t.onReadyBeingFired=null,t.isBeingOpened=!1}).then(function(){return e}).catch(function(c){t.dbOpenError=c;try{o&&o.abort()}catch{}return r===t.openCanceller&&e._close(),Y(c)}).finally(function(){t.openComplete=!0,a()})}function an(e){var t=function(o){return e.next(o)},n=function(o){return e.throw(o)},r=a(t),i=a(n);function a(o){return function(u){var s=o(u),c=s.value;return s.done?c:!c||typeof c.then!="function"?H(c)?Promise.all(c).then(r,i):r(c):c.then(r,i)}}return a(t)()}function Yi(e,t,n){var r=arguments.length;if(r<2)throw new k.InvalidArgument("Too few arguments");for(var i=new Array(r-1);--r;)i[r-1]=arguments[r];n=i.pop();var a=Wn(i);return[e,a,n]}function vr(e,t,n,r,i){return T.resolve().then(function(){var a=S.transless||S,o=e._createTransaction(t,n,e._dbSchema,r),u={trans:o,transless:a};if(r)o.idbtrans=r.idbtrans;else try{o.create(),e._state.PR1398_maxLoop=3}catch(l){return l.name===fn.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e._close(),e.open().then(function(){return vr(e,t,n,null,i)})):Y(l)}var s=cn(i);s&&Oe();var c,h=T.follow(function(){if(c=i.call(o,o),c)if(s){var l=he.bind(null,null);c.then(l,l)}else typeof c.next=="function"&&typeof c.throw=="function"&&(c=an(c))},u);return(c&&typeof c.then=="function"?T.resolve(c).then(function(l){return o.active?l:Y(new k.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):h.then(function(){return c})).then(function(l){return r&&o._resolve(),o._completion.then(function(){return l})}).catch(function(l){return o._reject(l),Y(l)})})}function st(e,t,n){for(var r=H(e)?e.slice():[e],i=0;i<n;++i)r.push(t);return r}function ji(e){return R(R({},e),{table:function(t){var n=e.table(t),r=n.schema,i={},a=[];function o(d,p,_){var g=He(d),m=i[g]=i[g]||[],b=d==null?0:typeof d=="string"?1:d.length,v=p>0,x=R(R({},_),{isVirtual:v,keyTail:p,keyLength:b,extractKey:$t(d),unique:!v&&_.unique});if(m.push(x),x.isPrimaryKey||a.push(x),b>1){var D=b===2?d[0]:d.slice(0,b-1);o(D,p+1,_)}return m.sort(function(E,A){return E.keyTail-A.keyTail}),x}var u=o(r.primaryKey.keyPath,0,r.primaryKey);i[":id"]=[u];for(var s=0,c=r.indexes;s<c.length;s++){var h=c[s];o(h.keyPath,0,h)}function l(d){var p=i[He(d)];return p&&p[0]}function f(d,p){return{type:d.type===1?2:d.type,lower:st(d.lower,d.lowerOpen?e.MAX_KEY:e.MIN_KEY,p),lowerOpen:!0,upper:st(d.upper,d.upperOpen?e.MIN_KEY:e.MAX_KEY,p),upperOpen:!0}}function w(d){var p=d.query.index;return p.isVirtual?R(R({},d),{query:{index:p,range:f(d.query.range,p.keyTail)}}):d}var y=R(R({},n),{schema:R(R({},r),{primaryKey:u,indexes:a,getIndexByKeyPath:l}),count:function(d){return n.count(w(d))},query:function(d){return n.query(w(d))},openCursor:function(d){var p=d.query.index,_=p.keyTail,g=p.isVirtual,m=p.keyLength;if(!g)return n.openCursor(d);function b(v){function x(E){E!=null?v.continue(st(E,d.reverse?e.MAX_KEY:e.MIN_KEY,_)):d.unique?v.continue(v.key.slice(0,m).concat(d.reverse?e.MIN_KEY:e.MAX_KEY,_)):v.continue()}var D=Object.create(v,{continue:{value:x},continuePrimaryKey:{value:function(E,A){v.continuePrimaryKey(st(E,e.MAX_KEY,_),A)}},primaryKey:{get:function(){return v.primaryKey}},key:{get:function(){var E=v.key;return m===1?E[0]:E.slice(0,m)}},value:{get:function(){return v.value}}});return D}return n.openCursor(w(d)).then(function(v){return v&&b(v)})}});return y}})}var Li={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:ji};function xn(e,t,n,r){return n=n||{},r=r||"",N(e).forEach(function(i){if(!Q(t,i))n[r+i]=void 0;else{var a=e[i],o=t[i];if(typeof a=="object"&&typeof o=="object"&&a&&o){var u=Yt(a),s=Yt(o);u!==s?n[r+i]=t[i]:u==="Object"?xn(a,o,n,r+i+"."):a!==o&&(n[r+i]=t[i])}else a!==o&&(n[r+i]=t[i])}}),N(t).forEach(function(i){Q(e,i)||(n[r+i]=t[i])}),n}function Vi(e,t){return t.type==="delete"?t.keys:t.keys||t.values.map(e.extractKey)}var Hi={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(e){return R(R({},e),{table:function(t){var n=e.table(t),r=n.schema.primaryKey,i=R(R({},n),{mutate:function(a){var o=S.trans,u=o.table(t).hook,s=u.deleting,c=u.creating,h=u.updating;switch(a.type){case"add":if(c.fire===B)break;return o._promise("readwrite",function(){return l(a)},!0);case"put":if(c.fire===B&&h.fire===B)break;return o._promise("readwrite",function(){return l(a)},!0);case"delete":if(s.fire===B)break;return o._promise("readwrite",function(){return l(a)},!0);case"deleteRange":if(s.fire===B)break;return o._promise("readwrite",function(){return f(a)},!0)}return n.mutate(a);function l(y){var d=S.trans,p=y.keys||Vi(r,y);if(!p)throw new Error("Keys missing");return y=y.type==="add"||y.type==="put"?R(R({},y),{keys:p}):R({},y),y.type!=="delete"&&(y.values=Ft([],y.values,!0)),y.keys&&(y.keys=Ft([],y.keys,!0)),Ui(n,y,p).then(function(_){var g=p.map(function(m,b){var v=_[b],x={onerror:null,onsuccess:null};if(y.type==="delete")s.fire.call(x,m,v,d);else if(y.type==="add"||v===void 0){var D=c.fire.call(x,m,y.values[b],d);m==null&&D!=null&&(m=D,y.keys[b]=m,r.outbound||$(y.values[b],r.keyPath,m))}else{var E=xn(v,y.values[b]),A=h.fire.call(x,E,m,v,d);if(A){var C=y.values[b];Object.keys(A).forEach(function(P){Q(C,P)?C[P]=A[P]:$(C,P,A[P])})}}return x});return n.mutate(y).then(function(m){for(var b=m.failures,v=m.results,x=m.numFailures,D=m.lastResult,E=0;E<p.length;++E){var A=v?v[E]:p[E],C=g[E];A==null?C.onerror&&C.onerror(b[E]):C.onsuccess&&C.onsuccess(y.type==="put"&&_[E]?y.values[E]:A)}return{failures:b,results:v,numFailures:x,lastResult:D}}).catch(function(m){return g.forEach(function(b){return b.onerror&&b.onerror(m)}),Promise.reject(m)})})}function f(y){return w(y.trans,y.range,1e4)}function w(y,d,p){return n.query({trans:y,values:!1,query:{index:r,range:d},limit:p}).then(function(_){var g=_.result;return l({type:"delete",keys:g,trans:y}).then(function(m){return m.numFailures>0?Promise.reject(m.failures[0]):g.length<p?{failures:[],numFailures:0,lastResult:void 0}:w(y,R(R({},d),{lower:g[g.length-1],lowerOpen:!0}),p)})})}}});return i}})}};function Ui(e,t,n){return t.type==="add"?Promise.resolve([]):e.getMany({trans:t.trans,keys:n,cache:"immutable"})}function yr(e,t,n){try{if(!t||t.keys.length<e.length)return null;for(var r=[],i=0,a=0;i<t.keys.length&&a<e.length;++i)z(t.keys[i],e[a])===0&&(r.push(n?qe(t.values[i]):t.values[i]),++a);return r.length===e.length?r:null}catch{return null}}var zi={stack:"dbcore",level:-1,create:function(e){return{table:function(t){var n=e.table(t);return R(R({},n),{getMany:function(r){if(!r.cache)return n.getMany(r);var i=yr(r.keys,r.trans._cache,r.cache==="clone");return i?T.resolve(i):n.getMany(r).then(function(a){return r.trans._cache={keys:r.keys,values:r.cache==="clone"?qe(a):a},a})},mutate:function(r){return r.type!=="add"&&(r.trans._cache=null),n.mutate(r)}})}}}},Ot;function En(e){return!("from"in e)}var ue=function(e,t){if(this)W(this,arguments.length?{d:1,from:e,to:arguments.length>1?t:e}:{d:0});else{var n=new ue;return e&&"d"in e&&W(n,e),n}};Pe(ue.prototype,(Ot={add:function(e){return Et(this,e),this},addKey:function(e){return Je(this,e,e),this},addKeys:function(e){var t=this;return e.forEach(function(n){return Je(t,n,n)}),this}},Ot[jt]=function(){return on(this)},Ot));function Je(e,t,n){var r=z(t,n);if(!isNaN(r)){if(r>0)throw RangeError();if(En(e))return W(e,{from:t,to:n,d:1});var i=e.l,a=e.r;if(z(n,e.from)<0)return i?Je(i,t,n):e.l={from:t,to:n,d:1,l:null,r:null},Nn(e);if(z(t,e.to)>0)return a?Je(a,t,n):e.r={from:t,to:n,d:1,l:null,r:null},Nn(e);z(t,e.from)<0&&(e.from=t,e.l=null,e.d=a?a.d+1:1),z(n,e.to)>0&&(e.to=n,e.r=null,e.d=e.l?e.l.d+1:1);var o=!e.r;i&&!e.l&&Et(e,i),a&&o&&Et(e,a)}}function Et(e,t){function n(r,i){var a=i.from,o=i.to,u=i.l,s=i.r;Je(r,a,o),u&&n(r,u),s&&n(r,s)}En(t)||n(e,t)}function Wi(e,t){var n=on(t),r=n.next();if(r.done)return!1;for(var i=r.value,a=on(e),o=a.next(i.from),u=o.value;!r.done&&!o.done;){if(z(u.from,i.to)<=0&&z(u.to,i.from)>=0)return!0;z(i.from,u.from)<0?i=(r=n.next(u.from)).value:u=(o=a.next(i.from)).value}return!1}function on(e){var t=En(e)?null:{s:0,n:e};return{next:function(n){for(var r=arguments.length>0;t;)switch(t.s){case 0:if(t.s=1,r)for(;t.n.l&&z(n,t.n.from)<0;)t={up:t,n:t.n.l,s:1};else for(;t.n.l;)t={up:t,n:t.n.l,s:1};case 1:if(t.s=2,!r||z(n,t.n.to)<=0)return{value:t.n,done:!1};case 2:if(t.n.r){t.s=3,t={up:t,n:t.n.r,s:0};continue}case 3:t=t.up}return{done:!0}}}}function Nn(e){var t,n,r=(((t=e.r)===null||t===void 0?void 0:t.d)||0)-(((n=e.l)===null||n===void 0?void 0:n.d)||0),i=r>1?"r":r<-1?"l":"";if(i){var a=i==="r"?"l":"r",o=R({},e),u=e[i];e.from=u.from,e.to=u.to,e[i]=u[i],o[i]=u[a],e[a]=o,o.d=Yn(o)}e.d=Yn(e)}function Yn(e){var t=e.r,n=e.l;return(t?n?Math.max(t.d,n.d):t.d:n?n.d:0)+1}var Gi={stack:"dbcore",level:0,create:function(e){var t=e.schema.name,n=new ue(e.MIN_KEY,e.MAX_KEY);return R(R({},e),{table:function(r){var i=e.table(r),a=i.schema,o=a.primaryKey,u=o.extractKey,s=o.outbound,c=R(R({},i),{mutate:function(f){var w=f.trans,y=w.mutatedParts||(w.mutatedParts={}),d=function(D){var E="idb://"+t+"/"+r+"/"+D;return y[E]||(y[E]=new ue)},p=d(""),_=d(":dels"),g=f.type,m=f.type==="deleteRange"?[f.range]:f.type==="delete"?[f.keys]:f.values.length<50?[[],f.values]:[],b=m[0],v=m[1],x=f.trans._cache;return i.mutate(f).then(function(D){if(H(b)){g!=="delete"&&(b=D.results),p.addKeys(b);var E=yr(b,x);!E&&g!=="add"&&_.addKeys(b),(E||v)&&Qi(d,a,E,v)}else if(b){var A={from:b.lower,to:b.upper};_.add(A),p.add(A)}else p.add(n),_.add(n),a.indexes.forEach(function(C){return d(C.name).add(n)});return D})}}),h=function(f){var w,y,d=f.query,p=d.index,_=d.range;return[p,new ue((w=_.lower)!==null&&w!==void 0?w:e.MIN_KEY,(y=_.upper)!==null&&y!==void 0?y:e.MAX_KEY)]},l={get:function(f){return[o,new ue(f.key)]},getMany:function(f){return[o,new ue().addKeys(f.keys)]},count:h,query:h,openCursor:h};return N(l).forEach(function(f){c[f]=function(w){var y=S.subscr;if(y){var d=function(x){var D="idb://"+t+"/"+r+"/"+x;return y[D]||(y[D]=new ue)},p=d(""),_=d(":dels"),g=l[f](w),m=g[0],b=g[1];if(d(m.name||"").add(b),!m.isPrimaryKey)if(f==="count")_.add(n);else{var v=f==="query"&&s&&w.values&&i.query(R(R({},w),{values:!1}));return i[f].apply(this,arguments).then(function(x){if(f==="query"){if(s&&w.values)return v.then(function(C){var P=C.result;return p.addKeys(P),x});var D=w.values?x.result.map(u):x.result;w.values?p.addKeys(D):_.addKeys(D)}else if(f==="openCursor"){var E=x,A=w.values;return E&&Object.create(E,{key:{get:function(){return _.addKey(E.primaryKey),E.key}},primaryKey:{get:function(){var C=E.primaryKey;return _.addKey(C),C}},value:{get:function(){return A&&p.addKey(E.primaryKey),E.value}}})}return x})}}return i[f].apply(this,arguments)}}),c}})}};function Qi(e,t,n,r){function i(a){var o=e(a.name||"");function u(c){return c!=null?a.extractKey(c):null}var s=function(c){return a.multiEntry&&H(c)?c.forEach(function(h){return o.addKey(h)}):o.addKey(c)};(n||r).forEach(function(c,h){var l=n&&u(n[h]),f=r&&u(r[h]);z(l,f)!==0&&(l!=null&&s(l),f!=null&&s(f))})}t.indexes.forEach(i)}var Tn=function(){function e(t,n){var r=this;this._middlewares={},this.verno=0;var i=e.dependencies;this._options=n=R({addons:e.addons,autoOpen:!0,indexedDB:i.indexedDB,IDBKeyRange:i.IDBKeyRange},n),this._deps={indexedDB:n.indexedDB,IDBKeyRange:n.IDBKeyRange};var a=n.addons;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var o={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:B,dbReadyPromise:null,cancelOpen:B,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3};o.dbReadyPromise=new T(function(u){o.dbReadyResolve=u}),o.openCanceller=new T(function(u,s){o.cancelOpen=s}),this._state=o,this.name=t,this.on=tt(this,"populate","blocked","versionchange","close",{ready:[hn,B]}),this.on.ready.subscribe=Vn(this.on.ready.subscribe,function(u){return function(s,c){e.vip(function(){var h=r._state;if(h.openComplete)h.dbOpenError||T.resolve().then(s),c&&u(s);else if(h.onReadyBeingFired)h.onReadyBeingFired.push(s),c&&u(s);else{u(s);var l=r;c||u(function f(){l.on.ready.unsubscribe(s),l.on.ready.unsubscribe(f)})}})}}),this.Collection=ci(this),this.Table=ii(this),this.Transaction=mi(this),this.Version=Pi(this),this.WhereClause=vi(this),this.on("versionchange",function(u){u.newVersion>0?console.warn("Another connection wants to upgrade database '"+r.name+"'. Closing db now to resume the upgrade."):console.warn("Another connection wants to delete database '"+r.name+"'. Closing db now to resume the delete request."),r.close()}),this.on("blocked",function(u){!u.newVersion||u.newVersion<u.oldVersion?console.warn("Dexie.delete('"+r.name+"') was blocked"):console.warn("Upgrade '"+r.name+"' blocked by other connection holding version "+u.oldVersion/10)}),this._maxKey=Xe(n.IDBKeyRange),this._createTransaction=function(u,s,c,h){return new r.Transaction(u,s,c,r._options.chromeTransactionDurability,h)},this._fireOnBlocked=function(u){r.on("blocked").fire(u),Ve.filter(function(s){return s.name===r.name&&s!==r&&!s._state.vcFired}).map(function(s){return s.on("versionchange").fire(u)})},this.use(Li),this.use(Hi),this.use(Gi),this.use(zi),this.vip=Object.create(this,{_vip:{value:!0}}),a.forEach(function(u){return u(r)})}return e.prototype.version=function(t){if(isNaN(t)||t<.1)throw new k.Type("Given version is not a positive number");if(t=Math.round(t*10)/10,this.idbdb||this._state.isBeingOpened)throw new k.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,t);var n=this._versions,r=n.filter(function(i){return i._cfg.version===t})[0];return r||(r=new this.Version(t),n.push(r),n.sort(Ti),r.stores({}),this._state.autoSchema=!1,r)},e.prototype._whenReady=function(t){var n=this;return this.idbdb&&(this._state.openComplete||S.letThrough||this._vip)?t():new T(function(r,i){if(n._state.openComplete)return i(new k.DatabaseClosed(n._state.dbOpenError));if(!n._state.isBeingOpened){if(!n._options.autoOpen){i(new k.DatabaseClosed);return}n.open().catch(B)}n._state.dbReadyPromise.then(r,i)}).then(t)},e.prototype.use=function(t){var n=t.stack,r=t.create,i=t.level,a=t.name;a&&this.unuse({stack:n,name:a});var o=this._middlewares[n]||(this._middlewares[n]=[]);return o.push({stack:n,create:r,level:i==null?10:i,name:a}),o.sort(function(u,s){return u.level-s.level}),this},e.prototype.unuse=function(t){var n=t.stack,r=t.name,i=t.create;return n&&this._middlewares[n]&&(this._middlewares[n]=this._middlewares[n].filter(function(a){return i?a.create!==i:r?a.name!==r:!1})),this},e.prototype.open=function(){return Ni(this)},e.prototype._close=function(){var t=this._state,n=Ve.indexOf(this);if(n>=0&&Ve.splice(n,1),this.idbdb){try{this.idbdb.close()}catch{}this._novip.idbdb=null}t.dbReadyPromise=new T(function(r){t.dbReadyResolve=r}),t.openCanceller=new T(function(r,i){t.cancelOpen=i})},e.prototype.close=function(){this._close();var t=this._state;this._options.autoOpen=!1,t.dbOpenError=new k.DatabaseClosed,t.isBeingOpened&&t.cancelOpen(t.dbOpenError)},e.prototype.delete=function(){var t=this,n=arguments.length>0,r=this._state;return new T(function(i,a){var o=function(){t.close();var u=t._deps.indexedDB.deleteDatabase(t.name);u.onsuccess=F(function(){Oi(t._deps,t.name),i()}),u.onerror=ne(a),u.onblocked=t._fireOnBlocked};if(n)throw new k.InvalidArgument("Arguments not allowed in db.delete()");r.isBeingOpened?r.dbReadyPromise.then(o):o()})},e.prototype.backendDB=function(){return this.idbdb},e.prototype.isOpen=function(){return this.idbdb!==null},e.prototype.hasBeenClosed=function(){var t=this._state.dbOpenError;return t&&t.name==="DatabaseClosed"},e.prototype.hasFailed=function(){return this._state.dbOpenError!==null},e.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(e.prototype,"tables",{get:function(){var t=this;return N(this._allTables).map(function(n){return t._allTables[n]})},enumerable:!1,configurable:!0}),e.prototype.transaction=function(){var t=Yi.apply(this,arguments);return this._transaction.apply(this,t)},e.prototype._transaction=function(t,n,r){var i=this,a=S.trans;(!a||a.db!==this||t.indexOf("!")!==-1)&&(a=null);var o=t.indexOf("?")!==-1;t=t.replace("!","").replace("?","");var u,s;try{if(s=n.map(function(h){var l=h instanceof i.Table?h.name:h;if(typeof l!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return l}),t=="r"||t===Rt)u=Rt;else if(t=="rw"||t==It)u=It;else throw new k.InvalidArgument("Invalid transaction mode: "+t);if(a){if(a.mode===Rt&&u===It)if(o)a=null;else throw new k.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");a&&s.forEach(function(h){if(a&&a.storeNames.indexOf(h)===-1)if(o)a=null;else throw new k.SubTransaction("Table "+h+" not included in parent transaction.")}),o&&a&&!a.active&&(a=null)}}catch(h){return a?a._promise(null,function(l,f){f(h)}):Y(h)}var c=vr.bind(null,this,u,s,a,r);return a?a._promise(u,c,"lock"):S.trans?Fe(S.transless,function(){return i._whenReady(c)}):this._whenReady(c)},e.prototype.table=function(t){if(!Q(this._allTables,t))throw new k.InvalidTable("Table "+t+" does not exist");return this._allTables[t]},e}(),Xi=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",Ji=function(){function e(t){this._subscribe=t}return e.prototype.subscribe=function(t,n,r){return this._subscribe(!t||typeof t=="function"?{next:t,error:n,complete:r}:t)},e.prototype[Xi]=function(){return this},e}();function mr(e,t){return N(t).forEach(function(n){var r=e[n]||(e[n]=new ue);Et(r,t[n])}),e}function qi(e){var t=!1,n=void 0,r=new Ji(function(i){var a=cn(e);function o(p){a&&Oe();var _=function(){return ge(e,{subscr:p,trans:null})},g=S.trans?Fe(S.transless,_):_();return a&&g.then(he,he),g}var u=!1,s={},c={},h={get closed(){return u},unsubscribe:function(){u=!0,be.storagemutated.unsubscribe(y)}};i.start&&i.start(h);var l=!1,f=!1;function w(){return N(c).some(function(p){return s[p]&&Wi(s[p],c[p])})}var y=function(p){mr(s,p),w()&&d()},d=function(){if(!(l||u)){s={};var p={},_=o(p);f||(be(Qe,y),f=!0),l=!0,Promise.resolve(_).then(function(g){t=!0,n=g,l=!1,!u&&(w()?d():(s={},c=p,i.next&&i.next(g)))},function(g){l=!1,t=!1,i.error&&i.error(g),h.unsubscribe()})}};return d(),h});return r.hasValue=function(){return t},r.getValue=function(){return n},r}var un;try{un={indexedDB:O.indexedDB||O.mozIndexedDB||O.webkitIndexedDB||O.msIndexedDB,IDBKeyRange:O.IDBKeyRange||O.webkitIDBKeyRange}}catch{un={indexedDB:null,IDBKeyRange:null}}var we=Tn;Pe(we,R(R({},Dt),{delete:function(e){var t=new we(e,{addons:[]});return t.delete()},exists:function(e){return new we(e,{addons:[]}).open().then(function(t){return t.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(e){try{return Mi(we.dependencies).then(e)}catch{return Y(new k.MissingAPI)}},defineClass:function(){function e(t){W(this,t)}return e},ignoreTransaction:function(e){return S.trans?Fe(S.transless,e):e()},vip:rn,async:function(e){return function(){try{var t=an(e.apply(this,arguments));return!t||typeof t.then!="function"?T.resolve(t):t}catch(n){return Y(n)}}},spawn:function(e,t,n){try{var r=an(e.apply(n,t||[]));return!r||typeof r.then!="function"?T.resolve(r):r}catch(i){return Y(i)}},currentTransaction:{get:function(){return S.trans||null}},waitFor:function(e,t){var n=T.resolve(typeof e=="function"?we.ignoreTransaction(e):e).timeout(t||6e4);return S.trans?S.trans.waitFor(n):n},Promise:T,debug:{get:function(){return re},set:function(e){Qn(e,e==="dexie"?function(){return!0}:sr)}},derive:Me,extend:W,props:Pe,override:Vn,Events:tt,on:be,liveQuery:qi,extendObservabilitySet:mr,getByKeyPath:le,setByKeyPath:$,delByKeyPath:Cr,shallowClone:zn,deepClone:qe,getObjectDiff:xn,cmp:z,asap:Hn,minKey:qt,addons:[],connections:Ve,errnames:fn,dependencies:un,semVer:In,version:In.split(".").map(function(e){return parseInt(e)}).reduce(function(e,t,n){return e+t/Math.pow(10,n*2)})}));we.maxKey=Xe(we.dependencies.IDBKeyRange);typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(be(Qe,function(e){if(!ce){var t;At?(t=document.createEvent("CustomEvent"),t.initCustomEvent(me,!0,!0,e)):t=new CustomEvent(me,{detail:e}),ce=!0,dispatchEvent(t),ce=!1}}),addEventListener(me,function(e){var t=e.detail;ce||Tt(t)}));function Tt(e){var t=ce;try{ce=!0,be.storagemutated.fire(e)}finally{ce=t}}var ce=!1;if(typeof BroadcastChannel<"u"){var ct=new BroadcastChannel(me);typeof ct.unref=="function"&&ct.unref(),be(Qe,function(e){ce||ct.postMessage(e)}),ct.onmessage=function(e){e.data&&Tt(e.data)}}else if(typeof self<"u"&&typeof navigator<"u"){be(Qe,function(e){try{ce||(typeof localStorage<"u"&&localStorage.setItem(me,JSON.stringify({trig:Math.random(),changedParts:e})),typeof self.clients=="object"&&Ft([],self.clients.matchAll({includeUncontrolled:!0}),!0).forEach(function(t){return t.postMessage({type:me,changedParts:e})}))}catch{}}),typeof addEventListener<"u"&&addEventListener("storage",function(e){if(e.key===me){var t=JSON.parse(e.newValue);t&&Tt(t.changedParts)}});var jn=self.document&&navigator.serviceWorker;jn&&jn.addEventListener("message",Zi)}function Zi(e){var t=e.data;t&&t.type===me&&Tt(t.changedParts)}T.rejectionMapper=Nr;Qn(re,sr);const U=new Tn("myDatabase");U.version("1.0").stores({timeRecord:"++id,date,time",tempTimeRecord:"++id,date,time"}).upgrade(e=>{});window.db=U;const $i={data(){return{startTime:null,runTime:0,runState:0,formattedTime:"00:00:00",timerInterval:null,historyRecords:[],addTime:0,search:{date:this.format(new Date,"YYYY-MM-DD")},timeId:-1,autoSaveTimer:null}},computed:{showRegress(){return this.format(new Date,"YYYY-MM-DD")==this.search.date&&[0,2].includes(this.runState)},showDelete(){return[0,2].includes(this.runState)}},watch:{runState:function(e){e===1?this.startAutoSave():this.stopAutoSave()}},mounted(){this.timeId=-1,this.getData(),this.init()},methods:{init(){window.addRecord=function(e){if(isNaN(new Date(e))||typeof e!="string")return alert("date\u5FC5\u987B\u662F\u683C\u5F0F\u5316\u65E5\u671F\u5B57\u7B26\u4E32\uFF0C\u5982"+this.format(new Date,"YYYY-MM-DD 23:30:00"));let t=window.prompt(`\u8BF7\u8F93\u5165 ${e} \u5BF9\u5E94\u7684\u5206\u949F\u6570`);if(!/\d*/.test(t))return alert("time\u5FC5\u987B\u6570\u5206\u949F\u6570\uFF08\u53EA\u542B\u6570\u5B57\uFF09");!confirm(`\u65E5\u671F ${e}\uFF0C\u5206\u949F\u6570:${t} ,\u662F\u5426\u786E\u8BA4\u6DFB\u52A0?`)||U.timeRecord.add({date:new Date(e),time:t*60*1e3}).then(n=>{this.getData()}).catch(n=>{alert("\u6DFB\u52A0\u5931\u8D25")})}.bind(this),console.log('\u624B\u52A8\u52A0\u8BB0\u5F55\u65B9\u6CD5 addRecord("'+this.format(new Date,"YYYY-MM-DD 23:30:00")+'")'),window.getTemp=function(){U.tempTimeRecord.toArray().then(e=>console.log(e.reverse()))},console.log("\u83B7\u5F97\u4E34\u65F6\u6570\u636E getTemp()"),window.addBatchTimeData=function(e){function t(n){return Object.prototype.toString.call(n).slice(8,-1).toLowerCase()}if(confirm("\u6DFB\u52A0\u662F\u5426\u6570\u636E\uFF1F")!==!1){console.log(e);for(let n of e){if(t(n.date)!=="date")return console.log("date\u6570\u636E\u4E0D\u5408\u89C4",n),alert("date\u6570\u636E\u4E0D\u5408\u89C4",n);if(t(n.time)!=="number")return console.log("time\u6570\u636E\u4E0D\u5408\u89C4",n),alert("time\u6570\u636E\u4E0D\u5408\u89C4",n)}U.timeRecord.bulkPut(e).then(()=>{alert("\u6570\u636E\u6DFB\u52A0\u6210\u529F")}).catch(n=>{console.error("\u65E0\u6CD5\u6DFB\u52A0\u6570\u636E:",n),alert("\u6570\u636E\u6DFB\u52A0\u6210\u529F")})}}},startAutoSave(){this.autoSaveTimer=setInterval(()=>{this.autoSaveHandle()},1e3*60*5)},stopAutoSave(){this.autoSaveHandle(),clearInterval(this.autoSaveTimer),this.autoSaveTimer=null},autoSaveHandle(){let e=this.runTime;if(this.runState===1&&(e+=performance.now()-this.startTime),e<60*1e3)return;let t={date:new Date().toLocaleString(),time:this.formatTime(Math.floor(e))};if(this.timeId!=-1){U.tempTimeRecord.update(this.timeId,t).then(()=>{}).catch(n=>{console.error("\u6570\u636E\u66F4\u65B0\u5931\u8D25:",n)});return}U.tempTimeRecord.add(t).then(async n=>{this.timeId=n;try{let r=await U.tempTimeRecord.count(),i=localStorage.getItem("tempTimeLength");i=Number(i)||10;let a=await U.tempTimeRecord.orderBy("id").limit(r-i).primaryKeys();if(a.length===0)return;await U.tempTimeRecord.bulkDelete(a)}catch(r){console.log(r),alert("\u5220\u9664\u81EA\u52A8\u4FDD\u5B58\u4E34\u65F6\u6570\u636E\u5931\u8D25")}}).catch(n=>{alert("\u81EA\u52A8\u4FDD\u5B58\u5931\u8D25")})},continueTime(e,t){confirm("\u662F\u5426\u786E\u8BA4\u7EE7\u7EED\uFF1F")!==!1&&(this.historyRecords.splice(e.oIdx,1),this.runTime+=e.time,this.startTime=performance.now(),U.timeRecord.delete(e.id).then(()=>{this.getData()}).catch(n=>{alert("\u6570\u636E\u5220\u9664\u5931\u8D25:",n)}),this.updateTimer())},deleteRecord(e,t){confirm(`\u662F\u5426\u5220\u9664${e.date},\u65F6\u957F\u4E3A${this.formatTime(e.time)}\u7684\u8BB0\u5F55 \uFF1F`)!==!1&&U.timeRecord.delete(e.id).then(()=>{this.getData()}).catch(n=>{alert("\u6570\u636E\u5220\u9664\u5931\u8D25:",n)})},addTimer(){confirm("\u662F\u5426\u786E\u8BA4\u52A0\u51CF\u65F6\u95F4?")!==!1&&(this.startTime=performance.now(),this.runTime+=this.addTime*1e3*60,this.runTime=Math.max(0,this.runTime),this.updateTimer())},startTimer(){this.startTime=performance.now(),this.updateTimer(),this.timerInterval=setInterval(this.updateTimer,1e3),this.runState=1},pauseTimer(){this.runTime+=performance.now()-this.startTime,this.startTime=performance.now(),this.runState=2,this.updateTimer(),clearInterval(this.timerInterval)},stopTimer(){clearInterval(this.timerInterval),this.runState===1&&(this.runTime+=performance.now()-this.startTime),U.timeRecord.add({date:new Date,time:Math.floor(this.runTime)}).then(e=>{this.startTime=null,this.formattedTime="00:00:00",this.runTime=0,this.runState=0,this.timeId=-1,this.getData()}).catch(e=>{alert("\u6DFB\u52A0\u5931\u8D25")})},getData(){let e=this.search.date;const t=new Date(this.format(new Date(e),"YYYY-MM-DD 00:00:00")),n=new Date(this.format(new Date(e),"YYYY-MM-DD 23:59:59"));U.timeRecord.where("date").between(t,n).toArray().then(r=>{if(r.length==0){this.historyRecords=[];return}r.forEach(i=>i.date=i.date.toLocaleString()),this.historyRecords=r}).catch(r=>{this.historyRecords=[],console.error("\u83B7\u5F97\u6570\u636E\u51FA\u9519",r)})},resetHistoryStorage(){confirm("\u662F\u5426\u786E\u8BA4\u5220\u9664\u6240\u6709\u5386\u53F2\u8BB0\u5F55?")!==!1&&U.timeRecord.clear().then(()=>{this.getData()}).catch(e=>{console.error("\u8868\u6570\u636E\u5220\u9664\u5931\u8D25:",e)})},updateTimer(){this.formattedTime=this.formatTime(performance.now()-this.startTime+this.runTime)},formatTime(e){e=Math.floor(Math.floor(e)/1e3);const t=Math.floor(e/3600).toString().padStart(2,"0"),n=Math.floor(e%3600/60).toString().padStart(2,"0"),r=(e%60).toString().padStart(2,"0");return`${t}:${n}:${r}`},format(e,t){var n={"M+":e.getMonth()+1,"D+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),"q+":Math.floor((e.getMonth()+3)/3),S:e.getMilliseconds()};/(Y+)/.test(t)&&(t=t.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length)));for(var r in n)new RegExp("("+r+")").test(t)&&(t=t.replace(RegExp.$1,RegExp.$1.length==1?n[r]:("00"+n[r]).substr((""+n[r]).length)));return t}}},Sn=e=>(Er("data-v-cf3579df"),e=e(),Tr(),e),ea={class:"timer_wrap"},ta=Sn(()=>L("header",{class:"timer_header"},"\u8BA1\u65F6\u5668",-1)),na=Sn(()=>L("hr",{class:"timer_hr"},null,-1)),ra={class:"timer_show"},ia=["disabled"],aa=["disabled"],oa=["disabled"],ua={class:"history_wrap"},sa={class:"history_header"},ca=xr(" \u5386\u53F2\u8BB0\u5F55 "),la=Sn(()=>L("hr",{class:"history_hr"},null,-1)),fa={id:"history"},ha={key:0,class:"content_loop_wrap"},da={class:"date"},pa={class:"studio_time"},va=["onClick"],ya=["onClick"],ma={key:1,class:"no_content_wrap"};function ga(e,t,n,r,i,a){return ie(),ae("div",null,[L("section",ea,[ta,na,L("div",ra,Ct(i.formattedTime),1),L("button",{disabled:!(i.runState==0||i.runState==2),class:"timer_btn start",onClick:t[0]||(t[0]=o=>a.startTimer())},"\u5F00\u59CB",8,ia),L("button",{disabled:i.runState!=1,class:"timer_btn pause",onClick:t[1]||(t[1]=o=>a.pauseTimer())},"\u6682\u505C",8,aa),L("button",{disabled:!(i.runState==1||i.runState==2),class:"timer_btn stop",onClick:t[2]||(t[2]=o=>a.stopTimer())},"\u7ED3\u675F",8,oa),i.runState==2?Dn((ie(),ae("input",{key:0,style:{width:"80px"},type:"number",class:"common_input","onUpdate:modelValue":t[3]||(t[3]=o=>i.addTime=o)},null,512)),[[An,i.addTime]]):ke("",!0),i.runState==2?(ie(),ae("button",{key:1,class:"timer_btn",onClick:t[4]||(t[4]=o=>a.addTimer())},"\u52A0\u51CF\u65F6")):ke("",!0)]),L("section",ua,[L("header",sa,[ca,L("div",null,[Dn(L("input",{type:"date",class:"common_input","onUpdate:modelValue":t[5]||(t[5]=o=>i.search.date=o),onChange:t[6]||(t[6]=(...o)=>a.getData&&a.getData(...o))},null,544),[[An,i.search.date]]),L("button",{class:"timer_btn",onClick:t[7]||(t[7]=(...o)=>a.resetHistoryStorage&&a.resetHistoryStorage(...o))},"\u91CD\u7F6E")])]),la,L("div",fa,[i.historyRecords.length!==0?(ie(),ae("div",ha,[(ie(!0),ae(br,null,wr(i.historyRecords,(o,u)=>(ie(),ae("div",{key:u,class:"content_wrap"},[L("div",da,Ct(a.format(new Date(o.date),"YYYY/MM/DD hh:mm:ss")),1),L("div",pa,Ct(a.formatTime(o.time)),1),a.showRegress?(ie(),ae("button",{key:0,style:{"margin-left":"10px"},onClick:s=>a.continueTime(o,u)},"\u7EE7\u7EED",8,va)):ke("",!0),a.showDelete?(ie(),ae("button",{key:1,style:{"margin-left":"10px"},onClick:s=>a.deleteRecord(o,u)},"\u5220\u9664",8,ya)):ke("",!0)]))),128))])):ke("",!0),i.historyRecords.length==0?(ie(),ae("div",ma," \u6682\u65E0\u6570\u636E... ")):ke("",!0)])])])}const ba=_r($i,[["render",ga],["__scopeId","data-v-cf3579df"]]);export{ba as default};
